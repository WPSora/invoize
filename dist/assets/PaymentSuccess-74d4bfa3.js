import{S as re,i as le,s as oe,E as U,I as fe,c as k,m as P,F as me,G as pe,j as $,t as v,l as h,H as ee,J as de,K as _e,M as $e,N as ve,e as _,d as y,f as u,k as f,X as be,O as ge,n as ae,o as ce,h as ie,P as te,a as w,u as V,B as ue,L as we,x as C,g,Q as q,p as ne}from"./Toaster.svelte_svelte_type_style_lang-89e761ff.js";import{C as ye,i as ke,h as H,a as Pe}from"./errorHelper-39e9d1d7.js";import{C as he}from"./card-footer-08d9ee18.js";import{c as se}from"./decimalFormatter-88348579.js";import{B as xe}from"./badge-check-96fb268f.js";import{X as W}from"./x-416feb5b.js";import{C as Ee}from"./check-ce36e405.js";function Ie(c){let e;const t=c[2].default,n=de(t,c,c[3],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&8)&&_e(n,t,r,r[3],e?ve(t,r[3],s,null):$e(r[3]),null)},i(r){e||($(n,r),e=!0)},o(r){v(n,r),e=!1},d(r){n&&n.d(r)}}}function Ce(c){let e,t;const n=[{name:"hourglass"},c[1],{iconNode:c[0]}];let r={$$slots:{default:[Ie]},$$scope:{ctx:c}};for(let s=0;s<n.length;s+=1)r=U(r,n[s]);return e=new fe({props:r}),{c(){k(e.$$.fragment)},m(s,l){P(e,s,l),t=!0},p(s,[l]){const o=l&3?me(n,[n[0],l&2&&pe(s[1]),l&1&&{iconNode:s[0]}]):{};l&8&&(o.$$scope={dirty:l,ctx:s}),e.$set(o)},i(s){t||($(e.$$.fragment,s),t=!0)},o(s){v(e.$$.fragment,s),t=!1},d(s){h(e,s)}}}function De(c,e,t){let{$$slots:n={},$$scope:r}=e;const s=[["path",{d:"M5 22h14"}],["path",{d:"M5 2h14"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"}]];return c.$$set=l=>{t(1,e=U(U({},e),ee(l))),"$$scope"in l&&t(3,r=l.$$scope)},e=ee(e),[s,e,n,r]}class Se extends re{constructor(e){super(),le(this,e,De,Ce,oe,{})}}const Ne=Se,X={PENDING:"PENDING",PAID:"PAID",SETTLED:"SETTLED",EXPIRED:"EXPIRED"};function Te(c){let e,t,n,r,s,l;return e=new xe({props:{class:"h-40 w-40 text-green-600 mb-2"}}),n=new Pe({props:{class:"flex flex-col justify-center items-center text-center",$$slots:{default:[Ae]},$$scope:{ctx:c}}}),s=new he({props:{$$slots:{default:[Be]},$$scope:{ctx:c}}}),{c(){k(e.$$.fragment),t=w(),k(n.$$.fragment),r=w(),k(s.$$.fragment)},m(o,a){P(e,o,a),u(o,t,a),P(n,o,a),u(o,r,a),P(s,o,a),l=!0},p(o,a){const i={};a&16397&&(i.$$scope={dirty:a,ctx:o}),n.$set(i);const p={};a&16384&&(p.$$scope={dirty:a,ctx:o}),s.$set(p)},i(o){l||($(e.$$.fragment,o),$(n.$$.fragment,o),$(s.$$.fragment,o),l=!0)},o(o){v(e.$$.fragment,o),v(n.$$.fragment,o),v(s.$$.fragment,o),l=!1},d(o){o&&(f(t),f(r)),h(e,o),h(n,o),h(s,o)}}}function Me(c){let e,t,n,r,s,l;return e=new W({props:{class:"h-40 w-40 text-destructive"}}),{c(){k(e.$$.fragment),t=w(),n=_("div"),n.textContent="There's something wrong with this payment",r=w(),s=_("div"),s.textContent="Please contact your merchant.",y(n,"class","text-2xl font-bold")},m(o,a){P(e,o,a),u(o,t,a),u(o,n,a),u(o,r,a),u(o,s,a),l=!0},p:V,i(o){l||($(e.$$.fragment,o),l=!0)},o(o){v(e.$$.fragment,o),l=!1},d(o){o&&(f(t),f(n),f(r),f(s)),h(e,o)}}}function Le(c){let e,t,n,r,s,l;return e=new W({props:{class:"h-40 w-40 text-destructive"}}),{c(){k(e.$$.fragment),t=w(),n=_("div"),n.textContent="Payment has Expired",r=w(),s=_("div"),s.textContent="Please contact your merchant.",y(n,"class","text-2xl font-bold")},m(o,a){P(e,o,a),u(o,t,a),u(o,n,a),u(o,r,a),u(o,s,a),l=!0},p:V,i(o){l||($(e.$$.fragment,o),l=!0)},o(o){v(e.$$.fragment,o),l=!1},d(o){o&&(f(t),f(n),f(r),f(s)),h(e,o)}}}function je(c){let e,t,n,r,s,l,o,a;return e=new Ne({props:{class:"h-40 w-40 text-yellow-500"}}),l=new ue({props:{$$slots:{default:[Fe]},$$scope:{ctx:c}}}),{c(){k(e.$$.fragment),t=w(),n=_("div"),n.textContent="Waiting for Payment",r=w(),s=_("a"),k(l.$$.fragment),y(n,"class","text-2xl font-bold mb-2"),y(s,"href",o=c[1].invoice_url),y(s,"target","_self")},m(i,p){P(e,i,p),u(i,t,p),u(i,n,p),u(i,r,p),u(i,s,p),P(l,s,null),a=!0},p(i,p){const x={};p&16384&&(x.$$scope={dirty:p,ctx:i}),l.$set(x),(!a||p&2&&o!==(o=i[1].invoice_url))&&y(s,"href",o)},i(i){a||($(e.$$.fragment,i),$(l.$$.fragment,i),a=!0)},o(i){v(e.$$.fragment,i),v(l.$$.fragment,i),a=!1},d(i){i&&(f(t),f(n),f(r),f(s)),h(e,i),h(l)}}}function Re(c){let e,t,n,r;return e=new we({props:{class:"h-40 w-40 text-primary animate-spin",strokeWidth:1}}),{c(){k(e.$$.fragment),t=w(),n=_("div"),n.textContent="Don't close this page while we process your payment...",y(n,"class","text-center")},m(s,l){P(e,s,l),u(s,t,l),u(s,n,l),r=!0},p:V,i(s){r||($(e.$$.fragment,s),r=!0)},o(s){v(e.$$.fragment,s),r=!1},d(s){s&&(f(t),f(n)),h(e,s)}}}function Xe(c){let e,t,n,r,s;return t=new W({props:{class:"h-4 w-4 text-destructive"}}),{c(){e=_("div"),k(t.$$.fragment),n=w(),r=_("div"),r.textContent="Failed to update your invoice payment status. Please contact your merchant.",y(r,"class","text-sm"),y(e,"class","flex flex-nowrap items-center justify-center gap-2 mt-3")},m(l,o){u(l,e,o),P(t,e,null),g(e,n),g(e,r),s=!0},i(l){s||($(t.$$.fragment,l),s=!0)},o(l){v(t.$$.fragment,l),s=!1},d(l){l&&f(e),h(t)}}}function ze(c){let e,t,n,r,s;return t=new Ee({props:{class:"h-4 w-4 text-green-600"}}),{c(){e=_("div"),k(t.$$.fragment),n=w(),r=_("div"),r.textContent="Invoice payment status has been updated",y(r,"class","text-sm"),y(e,"class","flex flex-nowrap items-center justify-center gap-2 mt-3")},m(l,o){u(l,e,o),P(t,e,null),g(e,n),g(e,r),s=!0},i(l){s||($(t.$$.fragment,l),s=!0)},o(l){v(t.$$.fragment,l),s=!1},d(l){l&&f(e),h(t)}}}function Ae(c){var O,Q;let e,t,n,r,s,l,o=c[0].invoiceNumber+"",a,i,p,x,T,M,N=se((Q=(O=c[0])==null?void 0:O.currency)==null?void 0:Q.name,c[0].total)+"",L,j,d,z,A,G,B,E,I,R,D;const J=[ze,Xe],S=[];function K(m,b){return m[3]?0:1}return E=K(c),I=S[E]=J[E](c),{c(){e=_("div"),e.textContent="Payment Successful",t=w(),n=_("div"),r=C("Your payment for "),s=_("b"),l=C("Invoice "),a=C(o),i=C(" has been successfully accepted."),p=w(),x=_("div"),T=C("Total Paid: "),M=_("b"),L=C(N),j=w(),d=_("div"),z=C("Payment Method: "),A=_("b"),G=C(c[2]),B=w(),I.c(),R=ae(),y(e,"class","text-2xl font-bold")},m(m,b){u(m,e,b),u(m,t,b),u(m,n,b),g(n,r),g(n,s),g(s,l),g(s,a),g(n,i),u(m,p,b),u(m,x,b),g(x,T),g(x,M),g(M,L),u(m,j,b),u(m,d,b),g(d,z),g(d,A),g(A,G),u(m,B,b),S[E].m(m,b),u(m,R,b),D=!0},p(m,b){var Y,Z;(!D||b&1)&&o!==(o=m[0].invoiceNumber+"")&&q(a,o),(!D||b&1)&&N!==(N=se((Z=(Y=m[0])==null?void 0:Y.currency)==null?void 0:Z.name,m[0].total)+"")&&q(L,N),(!D||b&4)&&q(G,m[2]);let F=E;E=K(m),E!==F&&(ce(),v(S[F],1,1,()=>{S[F]=null}),ie(),I=S[E],I||(I=S[E]=J[E](m),I.c()),$(I,1),I.m(R.parentNode,R))},i(m){D||($(I),D=!0)},o(m){v(I),D=!1},d(m){m&&(f(e),f(t),f(n),f(p),f(x),f(j),f(d),f(B),f(R)),S[E].d(m)}}}function Ge(c){let e;return{c(){e=C("Return to Invoice")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function Be(c){let e,t;return e=new ue({props:{$$slots:{default:[Ge]},$$scope:{ctx:c}}}),e.$on("click",c[7]),{c(){k(e.$$.fragment)},m(n,r){P(e,n,r),t=!0},p(n,r){const s={};r&16384&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){v(e.$$.fragment,n),t=!1},d(n){h(e,n)}}}function Fe(c){let e;return{c(){e=C("Pay now")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function qe(c){let e,t,n,r;const s=[Re,je,Le,Me,Te],l=[];function o(a,i){return!a[0]&&!a[4]&&!a[5]&&!a[6]?0:a[4]?1:a[5]?2:a[6]?3:4}return e=o(c),t=l[e]=s[e](c),{c(){t.c(),n=ae()},m(a,i){l[e].m(a,i),u(a,n,i),r=!0},p(a,i){let p=e;e=o(a),e===p?l[e].p(a,i):(ce(),v(l[p],1,1,()=>{l[p]=null}),ie(),t=l[e],t?t.p(a,i):(t=l[e]=s[e](a),t.c()),$(t,1),t.m(n.parentNode,n))},i(a){r||($(t),r=!0)},o(a){v(t),r=!1},d(a){a&&f(n),l[e].d(a)}}}function He(c){let e,t,n;return t=new ye({props:{class:"bg-gradient-to-tr from-slate-100 to-white flex flex-col justify-center items-center sm:w-1/2 w-10/12 h-1/2 relative",$$slots:{default:[qe]},$$scope:{ctx:c}}}),{c(){e=_("div"),k(t.$$.fragment),y(e,"class","w-full h-screen bg-gradient-to-tr from-primary to-primary-600 flex justify-center items-center")},m(r,s){u(r,e,s),P(t,e,null),n=!0},p(r,[s]){const l={};s&16511&&(l.$$scope={dirty:s,ctx:r}),t.$set(l)},i(r){n||($(t.$$.fragment,r),n=!0)},o(r){v(t.$$.fragment,r),n=!1},d(r){r&&f(e),h(t)}}}function Ue(c,e,t){let n;be(c,ke,d=>t(9,n=d));let r,s,l,o,a=!1,i=!1,p=!1,x=!1;const T=async()=>{try{const d=await te(`invoice/detail?invoizeToken=${r}`);t(0,s=d.data),n&&console.log(s)}catch(d){H(d)}},M=async()=>{try{await ne(`invoice/update?token=${r}&paymentStatus=paid&email=true`),t(3,a=!0)}catch(d){t(3,a=!1),H(d)}finally{await ne(`xendit/update?invoizeToken=${r}`),T()}},N=()=>{window.location.href=`${invoize.base_url}/invoize-preview/${r}`},L=()=>{const d=window.location.href;d.includes("xendit")?t(2,o="Xendit"):d.includes("paypal")&&t(2,o="Paypal")},j=async()=>{try{const d=await te(`xendit/detail?invoizeToken=${r}`);if(t(1,l=d.data.data),d.data.paymentStatus===X.PAID){t(3,a=!0),T();return}l.status===X.PAID||l.status===X.SETTLED?M():l.status===X.PENDING?t(4,i=!0):l.status===X.EXPIRED&&t(5,p=!0)}catch(d){t(6,x=!0),H(d)}};return ge(()=>{L(),r=new URLSearchParams(window.location.search).get("invoizeToken"),j()}),[s,l,o,a,i,p,x,N]}class Ze extends re{constructor(e){super(),le(this,e,Ue,He,oe,{})}}export{Ze as default};
