import{S as Be,i as Re,s as je,a4 as B,a5 as R,c as _,m as d,a6 as j,j as p,t as m,l as g,X as ae,a as k,f as b,k as h,r as ue,Z as oe,q as Qe,e as O,d as V,g as w,C as Xe,aa as Ye,p as ee,h as te,x as E,B as Ze,Q as Le,n as G,o as Ne,v as qe,w as ze,L as Ge}from"./Toaster.svelte_svelte_type_style_lang-7f7e6c6a.js";import{R as He,T as Je,D as Ke}from"./options-d5ba9c63.js";import{S as Me,a as Pe,b as Ae,V as Fe,c as fe}from"./index-dc1d53ab.js";import{L as z}from"./label-a6e03658.js";import{I as ie}from"./input-64299b06.js";import{w as W,M as Ue,F as We,h as et}from"./errorHelper-c5761fa6.js";import{i as tt}from"./emptyDataHelper-b583dd0c.js";import{a as nt,M as ne}from"./MiniStar-2f2d4797.js";import{C as lt}from"./CustomCurrencyInput-8b34c19a.js";import{D as rt}from"./dialog-header-655042da.js";import{D as st}from"./dialog-footer-22ba1d23.js";function De(s,e,t){const n=s.slice();return n[23]=e[t],n}function at(s){let e=s[3]?"Edit Tax":"Add New Tax",t;return{c(){t=E(e)},m(n,l){b(n,t,l)},p(n,l){l&8&&e!==(e=n[3]?"Edit Tax":"Add New Tax")&&Le(t,e)},d(n){n&&h(t)}}}function ut(s){let e,t;return e=new nt({props:{$$slots:{default:[at]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(n,l){d(e,n,l),t=!0},p(n,l){const r={};l&67108872&&(r.$$scope={dirty:l,ctx:n}),e.$set(r)},i(n){t||(p(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){g(e,n)}}}function ot(s){let e,t,n;return t=new ne({}),{c(){e=E("Name "),_(t.$$.fragment)},m(l,r){b(l,e,r),d(t,l,r),n=!0},i(l){n||(p(t.$$.fragment,l),n=!0)},o(l){m(t.$$.fragment,l),n=!1},d(l){l&&h(e),g(t,l)}}}function ft(s){let e;return{c(){e=E("Description")},m(t,n){b(t,e,n)},d(t){t&&h(e)}}}function it(s){let e,t,n;return t=new ne({}),{c(){e=E("Type "),_(t.$$.fragment)},m(l,r){b(l,e,r),d(t,l,r),n=!0},i(l){n||(p(t.$$.fragment,l),n=!0)},o(l){m(t.$$.fragment,l),n=!1},d(l){l&&h(e),g(t,l)}}}function ct(s){let e,t;return e=new Fe({props:{placeholder:"Select type"}}),{c(){_(e.$$.fragment)},m(n,l){d(e,n,l),t=!0},p:G,i(n){t||(p(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){g(e,n)}}}function $t(s){let e;return{c(){e=E("Percent (%)")},m(t,n){b(t,e,n)},d(t){t&&h(e)}}}function pt(s){let e;return{c(){e=E("Fixed")},m(t,n){b(t,e,n)},d(t){t&&h(e)}}}function mt(s){let e,t,n,l;return e=new fe({props:{value:"percent",$$slots:{default:[$t]},$$scope:{ctx:s}}}),n=new fe({props:{value:"fixed",$$slots:{default:[pt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=k(),_(n.$$.fragment)},m(r,a){d(e,r,a),b(r,t,a),d(n,r,a),l=!0},p(r,a){const f={};a&67108864&&(f.$$scope={dirty:a,ctx:r}),e.$set(f);const i={};a&67108864&&(i.$$scope={dirty:a,ctx:r}),n.$set(i)},i(r){l||(p(e.$$.fragment,r),p(n.$$.fragment,r),l=!0)},o(r){m(e.$$.fragment,r),m(n.$$.fragment,r),l=!1},d(r){r&&h(t),g(e,r),g(n,r)}}}function _t(s){let e,t,n,l;return e=new Pe({props:{id:"tax-type-select",class:"shadow-none",$$slots:{default:[ct]},$$scope:{ctx:s}}}),n=new Ae({props:{class:"max-h-60 overflow-y-auto",$$slots:{default:[mt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=k(),_(n.$$.fragment)},m(r,a){d(e,r,a),b(r,t,a),d(n,r,a),l=!0},p(r,a){const f={};a&67108864&&(f.$$scope={dirty:a,ctx:r}),e.$set(f);const i={};a&67108864&&(i.$$scope={dirty:a,ctx:r}),n.$set(i)},i(r){l||(p(e.$$.fragment,r),p(n.$$.fragment,r),l=!0)},o(r){m(e.$$.fragment,r),m(n.$$.fragment,r),l=!1},d(r){r&&h(t),g(e,r),g(n,r)}}}function Te(s){let e,t,n,l,r,a;t=new z({props:{for:"tax-currency-select",class:"mb-2",$$slots:{default:[dt]},$$scope:{ctx:s}}});function f(u){s[13](u)}let i={required:!0,$$slots:{default:[ht]},$$scope:{ctx:s}};return s[2].currency!==void 0&&(i.selected=s[2].currency),l=new Me({props:i}),B.push(()=>R(l,"selected",f)),{c(){e=O("div"),_(t.$$.fragment),n=k(),_(l.$$.fragment)},m(u,o){b(u,e,o),d(t,e,null),w(e,n),d(l,e,null),a=!0},p(u,o){const C={};o&67108864&&(C.$$scope={dirty:o,ctx:u}),t.$set(C);const S={};o&67108880&&(S.$$scope={dirty:o,ctx:u}),!r&&o&4&&(r=!0,S.selected=u[2].currency,j(()=>r=!1)),l.$set(S)},i(u){a||(p(t.$$.fragment,u),p(l.$$.fragment,u),a=!0)},o(u){m(t.$$.fragment,u),m(l.$$.fragment,u),a=!1},d(u){u&&h(e),g(t),g(l)}}}function dt(s){let e,t,n;return t=new ne({}),{c(){e=E("Currency "),_(t.$$.fragment)},m(l,r){b(l,e,r),d(t,l,r),n=!0},i(l){n||(p(t.$$.fragment,l),n=!0)},o(l){m(t.$$.fragment,l),n=!1},d(l){l&&h(e),g(t,l)}}}function gt(s){let e,t;return e=new Fe({props:{placeholder:"Select currency"}}),{c(){_(e.$$.fragment)},m(n,l){d(e,n,l),t=!0},p:G,i(n){t||(p(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){g(e,n)}}}function Oe(s){let e;return{c(){e=O("div"),e.textContent="You have no currencies saved",V(e,"class","text-sm p-2 text-muted-foreground italic")},m(t,n){b(t,e,n)},p:G,d(t){t&&h(e)}}}function vt(s){let e=s[23].name+"",t;return{c(){t=E(e)},m(n,l){b(n,t,l)},p(n,l){l&16&&e!==(e=n[23].name+"")&&Le(t,e)},d(n){n&&h(t)}}}function Ee(s){let e,t;return e=new fe({props:{value:s[23],$$slots:{default:[vt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(n,l){d(e,n,l),t=!0},p(n,l){const r={};l&16&&(r.value=n[23]),l&67108880&&(r.$$scope={dirty:l,ctx:n}),e.$set(r)},i(n){t||(p(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){g(e,n)}}}function bt(s){let e,t,n=qe(s[4]),l=[];for(let f=0;f<n.length;f+=1)l[f]=Ee(De(s,n,f));const r=f=>m(l[f],1,1,()=>{l[f]=null});let a=null;return n.length||(a=Oe()),{c(){for(let f=0;f<l.length;f+=1)l[f].c();e=Ne(),a&&a.c()},m(f,i){for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(f,i);b(f,e,i),a&&a.m(f,i),t=!0},p(f,i){if(i&16){n=qe(f[4]);let u;for(u=0;u<n.length;u+=1){const o=De(f,n,u);l[u]?(l[u].p(o,i),p(l[u],1)):(l[u]=Ee(o),l[u].c(),p(l[u],1),l[u].m(e.parentNode,e))}for(ee(),u=n.length;u<l.length;u+=1)r(u);te(),!n.length&&a?a.p(f,i):n.length?a&&(a.d(1),a=null):(a=Oe(),a.c(),a.m(e.parentNode,e))}},i(f){if(!t){for(let i=0;i<n.length;i+=1)p(l[i]);t=!0}},o(f){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)m(l[i]);t=!1},d(f){f&&h(e),ze(l,f),a&&a.d(f)}}}function ht(s){let e,t,n,l;return e=new Pe({props:{id:"tax-currency-select",class:"shadow-none",$$slots:{default:[gt]},$$scope:{ctx:s}}}),n=new Ae({props:{class:"max-h-60 overflow-y-auto",$$slots:{default:[bt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=k(),_(n.$$.fragment)},m(r,a){d(e,r,a),b(r,t,a),d(n,r,a),l=!0},p(r,a){const f={};a&67108864&&(f.$$scope={dirty:a,ctx:r}),e.$set(f);const i={};a&67108880&&(i.$$scope={dirty:a,ctx:r}),n.$set(i)},i(r){l||(p(e.$$.fragment,r),p(n.$$.fragment,r),l=!0)},o(r){m(e.$$.fragment,r),m(n.$$.fragment,r),l=!1},d(r){r&&h(t),g(e,r),g(n,r)}}}function wt(s){let e,t,n;return t=new ne({}),{c(){e=E("Amount "),_(t.$$.fragment)},m(l,r){b(l,e,r),d(t,l,r),n=!0},i(l){n||(p(t.$$.fragment,l),n=!0)},o(l){m(t.$$.fragment,l),n=!1},d(l){l&&h(e),g(t,l)}}}function yt(s){let e,t,n,l,r,a;function f(u){s[15](u)}let i={type:"number",id:"tax-value",placeholder:"Tax amount",required:!0};return s[2].value!==void 0&&(i.value=s[2].value),t=new ie({props:i}),B.push(()=>R(t,"value",f)),{c(){e=O("div"),_(t.$$.fragment),l=k(),r=O("div"),r.textContent="%",V(e,"class","flex flex-row items-center space-x-2")},m(u,o){b(u,e,o),d(t,e,null),w(e,l),w(e,r),a=!0},p(u,o){const C={};!n&&o&4&&(n=!0,C.value=u[2].value,j(()=>n=!1)),t.$set(C)},i(u){a||(p(t.$$.fragment,u),a=!0)},o(u){m(t.$$.fragment,u),a=!1},d(u){u&&h(e),g(t)}}}function kt(s){var a,f,i;let e,t,n;function l(u){s[14](u)}let r={inputClass:"text-start",currencyName:(i=(f=(a=s[2])==null?void 0:a.currency)==null?void 0:f.value)==null?void 0:i.name,placeholder:"Tax amount"};return s[2].value!==void 0&&(r.value=s[2].value),e=new lt({props:r}),B.push(()=>R(e,"value",l)),{c(){_(e.$$.fragment)},m(u,o){d(e,u,o),n=!0},p(u,o){var S,q,I;const C={};o&4&&(C.currencyName=(I=(q=(S=u[2])==null?void 0:S.currency)==null?void 0:q.value)==null?void 0:I.name),!t&&o&4&&(t=!0,C.value=u[2].value,j(()=>t=!1)),e.$set(C)},i(u){n||(p(e.$$.fragment,u),n=!0)},o(u){m(e.$$.fragment,u),n=!1},d(u){g(e,u)}}}function St(s){let e;return{c(){e=E("Save")},m(t,n){b(t,e,n)},i:G,o:G,d(t){t&&h(e)}}}function Ct(s){let e,t,n;return e=new Ge({props:{class:"h-4 w-4 mr-1 animate-spin text-white"}}),{c(){_(e.$$.fragment),t=E(`
            Saving`)},m(l,r){d(e,l,r),b(l,t,r),n=!0},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){m(e.$$.fragment,l),n=!1},d(l){l&&h(t),g(e,l)}}}function qt(s){let e,t,n,l;const r=[Ct,St],a=[];function f(i,u){return i[1]?0:1}return e=f(s),t=a[e]=r[e](s),{c(){t.c(),n=Ne()},m(i,u){a[e].m(i,u),b(i,n,u),l=!0},p(i,u){let o=e;e=f(i),e!==o&&(ee(),m(a[o],1,1,()=>{a[o]=null}),te(),t=a[e],t||(t=a[e]=r[e](i),t.c()),p(t,1),t.m(n.parentNode,n))},i(i){l||(p(t),l=!0)},o(i){m(t),l=!1},d(i){i&&h(n),a[e].d(i)}}}function Dt(s){let e,t;return e=new Ze({props:{type:"submit",disabled:s[1],$$slots:{default:[qt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(n,l){d(e,n,l),t=!0},p(n,l){const r={};l&2&&(r.disabled=n[1]),l&67108866&&(r.$$scope={dirty:l,ctx:n}),e.$set(r)},i(n){t||(p(e.$$.fragment,n),t=!0)},o(n){m(e.$$.fragment,n),t=!1},d(n){g(e,n)}}}function Tt(s){let e,t,n,l,r,a,f,i,u,o,C,S,q,I,L,Q,H,M,P,J,N,X,K,Y,A,c,Z,D,T,ce,x,U,le,$e;t=new rt({props:{$$slots:{default:[ut]},$$scope:{ctx:s}}}),f=new z({props:{for:"tax-name",$$slots:{default:[ot]},$$scope:{ctx:s}}});function Ie($){s[10]($)}let pe={id:"tax-name",type:"text",placeholder:"Tax name",required:!0};s[2].name!==void 0&&(pe.value=s[2].name),u=new ie({props:pe}),B.push(()=>R(u,"value",Ie)),q=new z({props:{for:"tax-description",$$slots:{default:[ft]},$$scope:{ctx:s}}});function xe($){s[11]($)}let me={id:"tax-description",type:"text",placeholder:"Tax description"};s[2].description!==void 0&&(me.value=s[2].description),L=new ie({props:me}),B.push(()=>R(L,"value",xe)),P=new z({props:{for:"tax-type-select",class:"mb-2",$$slots:{default:[it]},$$scope:{ctx:s}}});function Ve($){s[12]($)}let _e={required:!0,onSelectedChange:s[7],$$slots:{default:[_t]},$$scope:{ctx:s}};s[2].type!==void 0&&(_e.selected=s[2].type),N=new Me({props:_e}),B.push(()=>R(N,"selected",Ve));let y=s[2].type.value==="fixed"&&Te(s);c=new z({props:{for:"tax-value",$$slots:{default:[wt]},$$scope:{ctx:s}}});const de=[kt,yt],F=[];function ge($,v){return $[2].type.value==="fixed"?0:1}return D=ge(s),T=F[D]=de[D](s),x=new st({props:{$$slots:{default:[Dt]},$$scope:{ctx:s}}}),{c(){e=O("form"),_(t.$$.fragment),n=k(),l=O("div"),r=O("div"),a=O("div"),_(f.$$.fragment),i=k(),_(u.$$.fragment),C=k(),S=O("div"),_(q.$$.fragment),I=k(),_(L.$$.fragment),H=k(),M=O("div"),_(P.$$.fragment),J=k(),_(N.$$.fragment),K=k(),y&&y.c(),Y=k(),A=O("div"),_(c.$$.fragment),Z=k(),T.c(),ce=k(),_(x.$$.fragment),V(a,"class","space-y-2"),V(S,"class","space-y-2"),V(A,"class","space-y-2"),V(r,"class","grid grid-cols items-center gap-4"),V(l,"class","grid gap-4 py-4")},m($,v){b($,e,v),d(t,e,null),w(e,n),w(e,l),w(l,r),w(r,a),d(f,a,null),w(a,i),d(u,a,null),w(r,C),w(r,S),d(q,S,null),w(S,I),d(L,S,null),w(r,H),w(r,M),d(P,M,null),w(M,J),d(N,M,null),w(r,K),y&&y.m(r,null),w(r,Y),w(r,A),d(c,A,null),w(A,Z),F[D].m(A,null),w(e,ce),d(x,e,null),U=!0,le||($e=Xe(e,"submit",Ye(s[6])),le=!0)},p($,v){const ve={};v&67108872&&(ve.$$scope={dirty:v,ctx:$}),t.$set(ve);const be={};v&67108864&&(be.$$scope={dirty:v,ctx:$}),f.$set(be);const he={};!o&&v&4&&(o=!0,he.value=$[2].name,j(()=>o=!1)),u.$set(he);const we={};v&67108864&&(we.$$scope={dirty:v,ctx:$}),q.$set(we);const ye={};!Q&&v&4&&(Q=!0,ye.value=$[2].description,j(()=>Q=!1)),L.$set(ye);const ke={};v&67108864&&(ke.$$scope={dirty:v,ctx:$}),P.$set(ke);const re={};v&67108864&&(re.$$scope={dirty:v,ctx:$}),!X&&v&4&&(X=!0,re.selected=$[2].type,j(()=>X=!1)),N.$set(re),$[2].type.value==="fixed"?y?(y.p($,v),v&4&&p(y,1)):(y=Te($),y.c(),p(y,1),y.m(r,Y)):y&&(ee(),m(y,1,1,()=>{y=null}),te());const Se={};v&67108864&&(Se.$$scope={dirty:v,ctx:$}),c.$set(Se);let se=D;D=ge($),D===se?F[D].p($,v):(ee(),m(F[se],1,1,()=>{F[se]=null}),te(),T=F[D],T?T.p($,v):(T=F[D]=de[D]($),T.c()),p(T,1),T.m(A,null));const Ce={};v&67108866&&(Ce.$$scope={dirty:v,ctx:$}),x.$set(Ce)},i($){U||(p(t.$$.fragment,$),p(f.$$.fragment,$),p(u.$$.fragment,$),p(q.$$.fragment,$),p(L.$$.fragment,$),p(P.$$.fragment,$),p(N.$$.fragment,$),p(y),p(c.$$.fragment,$),p(T),p(x.$$.fragment,$),U=!0)},o($){m(t.$$.fragment,$),m(f.$$.fragment,$),m(u.$$.fragment,$),m(q.$$.fragment,$),m(L.$$.fragment,$),m(P.$$.fragment,$),m(N.$$.fragment,$),m(y),m(c.$$.fragment,$),m(T),m(x.$$.fragment,$),U=!1},d($){$&&h(e),g(t),g(f),g(u),g(q),g(L),g(P),g(N),y&&y.d(),g(c),F[D].d(),g(x),le=!1,$e()}}}function Ot(s){let e,t,n,l;return e=new Je({props:{id:"tax-modal"}}),n=new Ke({props:{class:"sm:max-w-[425px] ",$$slots:{default:[Tt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=k(),_(n.$$.fragment)},m(r,a){d(e,r,a),b(r,t,a),d(n,r,a),l=!0},p(r,a){const f={};a&67108894&&(f.$$scope={dirty:a,ctx:r}),n.$set(f)},i(r){l||(p(e.$$.fragment,r),p(n.$$.fragment,r),l=!0)},o(r){m(e.$$.fragment,r),m(n.$$.fragment,r),l=!1},d(r){r&&h(t),g(e,r),g(n,r)}}}function Et(s){let e,t,n;function l(a){s[16](a)}let r={onOpenChange:s[5],$$slots:{default:[Ot]},$$scope:{ctx:s}};return s[0]!==void 0&&(r.open=s[0]),e=new He({props:r}),B.push(()=>R(e,"open",l)),{c(){_(e.$$.fragment)},m(a,f){d(e,a,f),n=!0},p(a,[f]){const i={};f&67108894&&(i.$$scope={dirty:f,ctx:a}),!t&&f&1&&(t=!0,i.open=a[0],j(()=>t=!1)),e.$set(i)},i(a){n||(p(e.$$.fragment,a),n=!0)},o(a){m(e.$$.fragment,a),n=!1},d(a){g(e,a)}}}function Lt(s,e,t){let n,l,r;ae(s,W,c=>t(17,n=c)),ae(s,Ue,c=>t(18,l=c)),ae(s,We,c=>t(4,r=c));let{isEditState:a=!1}=e,{isOpen:f}=e,{isLoading:i}=e,{isDeleteModalOpen:u=!1}=e,{payload:o={id:null,name:"",description:"",type:{value:"percent",label:"Percent (%)"},currency:{value:null,label:null},value:""}}=e;const C=()=>{t(2,o={id:null,name:"",description:"",type:{value:"percent",label:"Percent (%)"},currency:{value:null,label:null},value:""})},S=()=>{t(0,f=!1),C()},q=()=>{L()&&(a?Q():H())},I=({value:c})=>{c==="fixed"?t(2,o.currency={label:l.name,value:{...l}},o):t(2,o.currency={label:null,value:null},o)},L=()=>{let c=!0;return o.type.value==="fixed"&&(!o.currency.value||!o.currency.label)&&(ue.error("Please choose currency"),c=!1),o.value||(ue.error("Please fill tax amount"),c=!1),c},Q=()=>{oe(W,n[o.id]={id:o.id,name:o.name,description:o.description??null,type:o.type.value,currency:o.currency.value,value:parseFloat(o.value)},n),M()},H=()=>{var Z;const c={name:o.name,description:o.description??null,type:o.type.value,currency:(Z=o.currency)==null?void 0:Z.value,value:parseFloat(o.value)};tt(n)&&oe(W,n=[],n),oe(W,n=[...n,c],n),M()},M=()=>{i||(t(1,i=!0),ue.promise(Qe("settings/update?tab=invoice",{taxes:n}),{loading:"Saving...",success:()=>(t(1,i=!1),t(0,f=!1),t(8,u=!1),"Tax Saved"),error:c=>(t(1,i=!1),et(c,"Failed to save tax"))}))};function P(c){s.$$.not_equal(o.name,c)&&(o.name=c,t(2,o))}function J(c){s.$$.not_equal(o.description,c)&&(o.description=c,t(2,o))}function N(c){s.$$.not_equal(o.type,c)&&(o.type=c,t(2,o))}function X(c){s.$$.not_equal(o.currency,c)&&(o.currency=c,t(2,o))}function K(c){s.$$.not_equal(o.value,c)&&(o.value=c,t(2,o))}function Y(c){s.$$.not_equal(o.value,c)&&(o.value=c,t(2,o))}function A(c){f=c,t(0,f)}return s.$$set=c=>{"isEditState"in c&&t(3,a=c.isEditState),"isOpen"in c&&t(0,f=c.isOpen),"isLoading"in c&&t(1,i=c.isLoading),"isDeleteModalOpen"in c&&t(8,u=c.isDeleteModalOpen),"payload"in c&&t(2,o=c.payload)},[f,i,o,a,r,S,q,I,u,M,P,J,N,X,K,Y,A]}class Qt extends Be{constructor(e){super(),Re(this,e,Lt,Et,je,{isEditState:3,isOpen:0,isLoading:1,isDeleteModalOpen:8,payload:2,submit:9})}get submit(){return this.$$.ctx[9]}}export{Qt as A};
