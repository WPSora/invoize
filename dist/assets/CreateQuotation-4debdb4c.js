import{S as We,i as ze,s as Ge,a4 as A,a5 as y,a as $,c as L,e as re,d as H,f as C,m as O,g as be,j as h,o as de,t as k,h as me,a6 as v,k as w,l as B,X as p,O as dt,Z as S,a2 as Oe,n as mt,B as ft,z as pt,a7 as Be,x as X,C as _t,v as fe,P as gt,ab as he,L as bt,Q as Se,q as se,p as Dt}from"./Toaster.svelte_svelte_type_style_lang-3086cbd0.js";import{t as ht}from"./triggerTabUpdateHelper-54f25315.js";import{S as Te,c as Tt}from"./enum-9d62bdc6.js";import{s as pe,p as ke,o as qe,m as ve,n as Ne,q as St,r as kt,t as Ct,x as wt,u as Mt}from"./errorHelper-eef9e97b.js";import{w as Qe,i as Fe,c as Ye,a as Ie,s as _e,b as Ce,d as we,e as Me,f as Ee,g as Pe,h as Ae,j as Re,k as ye,l as Le,m as Et,n as je,r as Pt,o as At,t as yt,p as Lt,q as Ot,u as Bt,v as qt,x as vt,y as Nt,z as Qt,A as Ft}from"./invoice-store-89da11de.js";import{h as Yt}from"./invoiceErrorHelper-13369b1f.js";import{B as It,O as Rt,c as jt,s as Ut}from"./Options-60264e68.js";import{_ as Vt}from"./main-236b23fb.js";import{A as Kt,a as Wt,b as zt}from"./index-0984da6d.js";import{C as Gt,s as Ue}from"./index-2f32262e.js";import{g as He}from"./styles-e7e55f44.js";import{i as ae}from"./emptyDataHelper-b583dd0c.js";import{h as ge}from"./moment-a9aaa855.js";import{I as Xe}from"./input-342b31a9.js";import{L as Ht}from"./label-7d3a217f.js";import{B as Xt}from"./Breadcrumb-8a216a28.js";import{S as Zt}from"./send-e1cefc13.js";import"./invoice-list-store-3ca58dd7.js";import"./table-row-9bf80d0a.js";import"./card-footer-7cfda621.js";import"./index-d3c8ba18.js";import"./updater-cbd8223a.js";import"./options-89ca2928.js";import"./x-e55b9835.js";import"./helpers-9268112f.js";import"./separator-d7b15c7c.js";import"./MiniStar-4e4614b7.js";import"./Plus-e1a813d4.js";import"./Trash-c1f21d44.js";import"./Select-aaeb8f73.js";import"./index-7095afc4.js";import"./arrays-9d05857f.js";import"./Check-fa20f0eb.js";import"./action-39728114.js";import"./create-e552ce8d.js";import"./decimalFormatter-88348579.js";import"./saveToStoreHelper-e7988ee0.js";import"./MultilineText-07aaf54e.js";import"./dialog-header-208ee491.js";import"./dialog-footer-e40dcf9d.js";import"./dialog-description-776c5d22.js";import"./dialog-description-42b79c51.js";import"./customer-modal-96845865.js";import"./switch-b7e944c0.js";import"./product-modal-3f3c8373.js";import"./CustomCurrencyInput-d3541a18.js";import"./capitalHelper-77c0a756.js";import"./search-b20aeeac.js";import"./checkbox-3eb65d0a.js";import"./index-4f0b7d19.js";import"./card-description-e849d062.js";import"./pluralHelper-a32d0151.js";import"./add-discount-modal-7bc175c5.js";import"./add-tax-modal-c2b7393b.js";import"./add-reminder-modal-6c4f373e.js";import"./UpgradeToProButton-e020fdbc.js";import"./chevron-down-a8868dd9.js";import"./ProBadge-35078e4e.js";function Ve(t){let n,e,o,s;function c(a){t[26](a)}var f=t[6];function l(a){let m={isLoading:a[4]};return a[8]!==void 0&&(m.open=a[8]),{props:m}}return f&&(n=Oe(f,l(t)),A.push(()=>y(n,"open",c)),n.$on("createAndSend",t[27])),{c(){n&&L(n.$$.fragment),o=mt()},m(a,m){n&&O(n,a,m),C(a,o,m),s=!0},p(a,m){const d={};if(m[0]&16&&(d.isLoading=a[4]),!e&&m[0]&256&&(e=!0,d.open=a[8],v(()=>e=!1)),m[0]&64&&f!==(f=a[6])){if(n){de();const g=n;k(g.$$.fragment,1,0,()=>{B(g,1)}),me()}f?(n=Oe(f,l(a)),A.push(()=>y(n,"open",c)),n.$on("createAndSend",a[27]),L(n.$$.fragment),h(n.$$.fragment,1),O(n,o.parentNode,o)):n=null}else f&&n.$set(d)},i(a){s||(n&&h(n.$$.fragment,a),s=!0)},o(a){n&&k(n.$$.fragment,a),s=!1},d(a){a&&w(o),n&&B(n,a)}}}function Ke(t){let n,e;return n=new Kt({props:{variant:"warning",class:"mt-4",$$slots:{default:[en]},$$scope:{ctx:t}}}),{c(){L(n.$$.fragment)},m(o,s){O(n,o,s),e=!0},p(o,s){const c={};s[1]&268435456&&(c.$$scope={dirty:s,ctx:o}),n.$set(c)},i(o){e||(h(n.$$.fragment,o),e=!0)},o(o){k(n.$$.fragment,o),e=!1},d(o){B(n,o)}}}function Jt(t){let n;return{c(){n=X("Missing Payment Method")},m(e,o){C(e,n,o)},d(e){e&&w(n)}}}function xt(t){let n;return{c(){n=X("Please go to settings and manage your payment method")},m(e,o){C(e,n,o)},d(e){e&&w(n)}}}function $t(t){let n;return{c(){n=X("Go to Settings")},m(e,o){C(e,n,o)},d(e){e&&w(n)}}}function en(t){let n,e,o,s,c,f;return n=new Wt({props:{$$slots:{default:[Jt]},$$scope:{ctx:t}}}),o=new zt({props:{$$slots:{default:[xt]},$$scope:{ctx:t}}}),c=new ft({props:{variant:"link",class:"text-xs p-0",$$slots:{default:[$t]},$$scope:{ctx:t}}}),c.$on("click",t[22]),{c(){L(n.$$.fragment),e=$(),L(o.$$.fragment),s=$(),L(c.$$.fragment)},m(l,a){O(n,l,a),C(l,e,a),O(o,l,a),C(l,s,a),O(c,l,a),f=!0},p(l,a){const m={};a[1]&268435456&&(m.$$scope={dirty:a,ctx:l}),n.$set(m);const d={};a[1]&268435456&&(d.$$scope={dirty:a,ctx:l}),o.$set(d);const g={};a[1]&268435456&&(g.$$scope={dirty:a,ctx:l}),c.$set(g)},i(l){f||(h(n.$$.fragment,l),h(o.$$.fragment,l),h(c.$$.fragment,l),f=!0)},o(l){k(n.$$.fragment,l),k(o.$$.fragment,l),k(c.$$.fragment,l),f=!1},d(l){l&&(w(e),w(s)),B(n,l),B(o,l),B(c,l)}}}function tn(t){let n;return{c(){n=X("QUOTATION")},m(e,o){C(e,n,o)},d(e){e&&w(n)}}}function nn(t){let n;function e(c,f){return c[5]?an:sn}let o=e(t),s=o(t);return{c(){n=re("p"),s.c(),H(n,"class","text-2xl font-bold")},m(c,f){C(c,n,f),s.m(n,null)},p(c,f){o===(o=e(c))&&s?s.p(c,f):(s.d(1),s=o(c),s&&(s.c(),s.m(n,null)))},i:fe,o:fe,d(c){c&&w(n),s.d()}}}function on(t){let n,e;return n=new bt({props:{class:"h-5 w-5 animate-spin text-primary mt-1"}}),{c(){L(n.$$.fragment)},m(o,s){O(n,o,s),e=!0},p:fe,i(o){e||(h(n.$$.fragment,o),e=!0)},o(o){k(n.$$.fragment,o),e=!1},d(o){B(n,o)}}}function sn(t){let n,e;return{c(){n=X(t[15]),e=X(t[14])},m(o,s){C(o,n,s),C(o,e,s)},p(o,s){s[0]&32768&&Se(n,o[15]),s[0]&16384&&Se(e,o[14])},d(o){o&&(w(n),w(e))}}}function an(t){let n;return{c(){n=X(t[21])},m(e,o){C(e,n,o)},p(e,o){o[0]&2097152&&Se(n,e[21])},d(e){e&&w(n)}}}function rn(t){let n,e,o,s,c,f;e=new Gt({props:{class:"sm:text-[42px] text-[24px] font-bold mb-2",$$slots:{default:[tn]},$$scope:{ctx:t}}});const l=[on,nn],a=[];function m(d,g){return d[9]?0:1}return s=m(t),c=a[s]=l[s](t),{c(){n=re("div"),L(e.$$.fragment),o=$(),c.c(),H(n,"slot","header-title"),H(n,"class","flex flex-col items-end")},m(d,g){C(d,n,g),O(e,n,null),be(n,o),a[s].m(n,null),f=!0},p(d,g){const T={};g[1]&268435456&&(T.$$scope={dirty:g,ctx:d}),e.$set(T);let N=s;s=m(d),s===N?a[s].p(d,g):(de(),k(a[N],1,1,()=>{a[N]=null}),me(),c=a[s],c?c.p(d,g):(c=a[s]=l[s](d),c.c()),h(c,1),c.m(n,null))},i(d){f||(h(e.$$.fragment,d),h(c),f=!0)},o(d){k(e.$$.fragment,d),k(c),f=!1},d(d){d&&w(n),B(e),a[s].d()}}}function un(t){let n;return{c(){n=X("Quotation date")},m(e,o){C(e,n,o)},d(e){e&&w(n)}}}function ln(t){let n,e,o,s,c,f;e=new Ht({props:{for:"quotation-date",$$slots:{default:[un]},$$scope:{ctx:t}}});function l(m){t[29](m)}let a={id:"quotation-date",type:"date",placeholder:"Quotation date",class:"relative"};return t[0]!==void 0&&(a.value=t[0]),s=new Xe({props:a}),A.push(()=>y(s,"value",l)),{c(){n=re("div"),L(e.$$.fragment),o=$(),L(s.$$.fragment),H(n,"class",He)},m(m,d){C(m,n,d),O(e,n,null),be(n,o),O(s,n,null),f=!0},p(m,d){const g={};d[1]&268435456&&(g.$$scope={dirty:d,ctx:m}),e.$set(g);const T={};!c&&d[0]&1&&(c=!0,T.value=m[0],v(()=>c=!1)),s.$set(T)},i(m){f||(h(e.$$.fragment,m),h(s.$$.fragment,m),f=!0)},o(m){k(e.$$.fragment,m),k(s.$$.fragment,m),f=!1},d(m){m&&w(n),B(e),B(s)}}}function cn(t){let n,e,o,s,c;function f(a){t[28](a)}let l={id:"due-date",type:"date",class:"relative"};return t[2]!==void 0&&(l.value=t[2]),e=new Xe({props:l}),A.push(()=>y(e,"value",f)),{c(){n=re("div"),L(e.$$.fragment),H(n,"slot","due-date"),H(n,"class",He)},m(a,m){C(a,n,m),O(e,n,null),c=!0},p(a,m){const d={};!o&&m[0]&4&&(o=!0,d.value=a[2],v(()=>o=!1)),e.$set(d)},i(a){c||(h(e.$$.fragment,a),a&&pt(()=>{c&&(s||(s=Be(n,Ue,{},!0)),s.run(1))}),c=!0)},o(a){k(e.$$.fragment,a),a&&(s||(s=Be(n,Ue,{},!1)),s.run(0)),c=!1},d(a){a&&w(n),B(e),a&&s&&s.end()}}}function dn(t){let n,e,o,s,c,f;return e=new Zt({props:{class:"h-4 w-4 mr-3"}}),{c(){n=re("button"),L(e.$$.fragment),o=X(`
      Save and Send E-mail`),H(n,"slot","save-options"),H(n,"class","w-full px-5 py-3 rounded-sm text-sm font-medium flex items-center justify-center outline-none hover:bg-gradient-to-tr hover:from-primary hover:to-primary-500 hover:text-background")},m(l,a){C(l,n,a),O(e,n,null),be(n,o),s=!0,c||(f=_t(n,"click",t[36]),c=!0)},p:fe,i(l){s||(h(e.$$.fragment,l),s=!0)},o(l){k(e.$$.fragment,l),s=!1},d(l){l&&w(n),B(e),c=!1,f()}}}function mn(t){let n,e,o,s=!t[10]&&ae(t[16])&&ae(t[17])&&ae(t[18])&&(!t[19]||!t[20]),c,f,l,a,m,d,g,T,N,M,K,R,j,U,V,b=!t[5]&&t[6]&&Ve(t);e=new Xt({props:{to:t[3]}});let D=s&&Ke(t);function Z(r){t[30](r)}function W(r){t[31](r)}function J(r){t[32](r)}function F(r){t[33](r)}function oe(r){t[34](r)}let q={isEdit:t[5],selectedDueDateBind:t[1],$$slots:{"due-date":[cn],"order-date":[ln],"header-title":[rn]},$$scope:{ctx:t}};t[9]!==void 0&&(q.isLoadingSettings=t[9]),t[11]!==void 0&&(q.isDiscountModalOpen=t[11]),t[12]!==void 0&&(q.discountData=t[12]),t[13]!==void 0&&(q.discountTemporaryEdit=t[13]),t[10]!==void 0&&(q.isLoadingPayment=t[10]),l=new It({props:q}),A.push(()=>y(l,"isLoadingSettings",Z)),A.push(()=>y(l,"isDiscountModalOpen",W)),A.push(()=>y(l,"discountData",J)),A.push(()=>y(l,"discountTemporaryEdit",F)),A.push(()=>y(l,"isLoadingPayment",oe)),l.$on("updateDueDate",t[35]),l.$on("settingsFetched",t[23]);function x(r){t[37](r)}function Y(r){t[38](r)}function Q(r){t[39](r)}function z(r){t[40](r)}let I={isEdit:t[5],isLoadingSettings:t[9],$$slots:{"save-options":[dn]},$$scope:{ctx:t}};return t[7]!==void 0&&(I.isFinishModalOpen=t[7]),t[11]!==void 0&&(I.isDiscountModalOpen=t[11]),t[12]!==void 0&&(I.discountData=t[12]),t[13]!==void 0&&(I.discountTemporaryEdit=t[13]),M=new Rt({props:I}),A.push(()=>y(M,"isFinishModalOpen",x)),A.push(()=>y(M,"isDiscountModalOpen",Y)),A.push(()=>y(M,"discountData",Q)),A.push(()=>y(M,"discountTemporaryEdit",z)),M.$on("submit",t[41]),{c(){b&&b.c(),n=$(),L(e.$$.fragment),o=$(),D&&D.c(),c=$(),f=re("div"),L(l.$$.fragment),N=$(),L(M.$$.fragment),H(f,"class","flex xl:flex-row xl:flex-nowrap flex-wrap justify-center mt-5")},m(r,_){b&&b.m(r,_),C(r,n,_),O(e,r,_),C(r,o,_),D&&D.m(r,_),C(r,c,_),C(r,f,_),O(l,f,null),be(f,N),O(M,f,null),V=!0},p(r,_){!r[5]&&r[6]?b?(b.p(r,_),_[0]&96&&h(b,1)):(b=Ve(r),b.c(),h(b,1),b.m(n.parentNode,n)):b&&(de(),k(b,1,1,()=>{b=null}),me());const ee={};_[0]&8&&(ee.to=r[3]),e.$set(ee),_[0]&2032640&&(s=!r[10]&&ae(r[16])&&ae(r[17])&&ae(r[18])&&(!r[19]||!r[20])),s?D?(D.p(r,_),_[0]&2032640&&h(D,1)):(D=Ke(r),D.c(),h(D,1),D.m(c.parentNode,c)):D&&(de(),k(D,1,1,()=>{D=null}),me());const E={};_[0]&32&&(E.isEdit=r[5]),_[0]&2&&(E.selectedDueDateBind=r[1]),_[0]&2146853|_[1]&268435456&&(E.$$scope={dirty:_,ctx:r}),!a&&_[0]&512&&(a=!0,E.isLoadingSettings=r[9],v(()=>a=!1)),!m&&_[0]&2048&&(m=!0,E.isDiscountModalOpen=r[11],v(()=>m=!1)),!d&&_[0]&4096&&(d=!0,E.discountData=r[12],v(()=>d=!1)),!g&&_[0]&8192&&(g=!0,E.discountTemporaryEdit=r[13],v(()=>g=!1)),!T&&_[0]&1024&&(T=!0,E.isLoadingPayment=r[10],v(()=>T=!1)),l.$set(E);const P={};_[0]&32&&(P.isEdit=r[5]),_[0]&512&&(P.isLoadingSettings=r[9]),_[0]&448|_[1]&268435456&&(P.$$scope={dirty:_,ctx:r}),!K&&_[0]&128&&(K=!0,P.isFinishModalOpen=r[7],v(()=>K=!1)),!R&&_[0]&2048&&(R=!0,P.isDiscountModalOpen=r[11],v(()=>R=!1)),!j&&_[0]&4096&&(j=!0,P.discountData=r[12],v(()=>j=!1)),!U&&_[0]&8192&&(U=!0,P.discountTemporaryEdit=r[13],v(()=>U=!1)),M.$set(P)},i(r){V||(h(b),h(e.$$.fragment,r),h(D),h(l.$$.fragment,r),h(M.$$.fragment,r),V=!0)},o(r){k(b),k(e.$$.fragment,r),k(D),k(l.$$.fragment,r),k(M.$$.fragment,r),V=!1},d(r){r&&(w(n),w(o),w(c),w(f)),b&&b.d(r),B(e,r),D&&D.d(r),B(l),B(M)}}}function fn(t,n,e){let o,s,c,f,l,a,m,d,g,T,N,M,K,R,j,U,V,b,D,Z,W,J,F,oe,q;p(t,Qe,i=>e(42,o=i)),p(t,Fe,i=>e(43,s=i)),p(t,Ye,i=>e(44,c=i)),p(t,Ie,i=>e(45,f=i)),p(t,_e,i=>e(25,l=i)),p(t,Ce,i=>e(46,a=i)),p(t,we,i=>e(47,m=i)),p(t,Me,i=>e(48,d=i)),p(t,Ee,i=>e(49,g=i)),p(t,Pe,i=>e(50,T=i)),p(t,Ae,i=>e(51,N=i)),p(t,Re,i=>e(52,M=i)),p(t,ye,i=>e(53,K=i)),p(t,Le,i=>e(54,R=i)),p(t,pe,i=>e(14,j=i)),p(t,ke,i=>e(15,U=i)),p(t,qe,i=>e(55,V=i)),p(t,ve,i=>e(56,b=i)),p(t,Ne,i=>e(57,D=i)),p(t,St,i=>e(16,Z=i)),p(t,kt,i=>e(17,W=i)),p(t,Ct,i=>e(18,J=i)),p(t,wt,i=>e(19,F=i)),p(t,Mt,i=>e(20,oe=i)),p(t,Et,i=>e(21,q=i));let x,{nav:Y}=n,{selectedQuotationDate:Q=ge().format("YYYY-MM-DD")}=n,{selectedDueDate:z}=n,{selectedDueDateBind:I=null}=n,{selectedDueDateCustom:r}=n,{isSubmitting:_=!1}=n,{isEdit:ee=!1}=n,E=!1,P=!1,ue=!1,le=!1,te=!1,ne,ie;const u=()=>{S(Ne,D=Te.PAYMENT.VALUE,D),S(ve,b=Te.PAYMENT.TAB2.PAYMENT_METHOD.VALUE,b),S(qe,V=Te.PAYMENT.TAB2.PAYMENT_METHOD.TAB3.BANK,V),window.location.href="#/setting",window.scrollTo(0,0)},G=()=>{gt("settings/retrieve?tab=quotation",i=>{i.data.data.map(ce=>{ce.name=="prefix"&&S(ke,U=ce.value,U),ce.name=="startFromNumber"&&S(pe,j=ce.value,j)})})};dt(()=>()=>{S(Le,R=null,R),S(ye,K=null,K),S(Re,M=null,M),S(Ae,N=[],N),S(Pe,T=[],T),S(Ee,g=[],g),S(Me,d=null,d),S(we,m=[],m),S(Ce,a=[],a),S(_e,l=null,l),S(Ie,f=[],f),S(Ye,c=[],c),S(Fe,s=!1,s),S(Qe,o=null,o)});function De(i){P=i,e(8,P)}function Ze(i){he.call(this,t,i)}function Je(i){r=i,e(2,r)}function xe(i){Q=i,e(0,Q)}function $e(i){ue=i,e(9,ue)}function et(i){te=i,e(11,te)}function tt(i){ne=i,e(12,ne)}function nt(i){ie=i,e(13,ie)}function it(i){le=i,e(10,le)}function ot(i){he.call(this,t,i)}const st=()=>{Vt(()=>import("./send-invoice-modal-c5c38164.js"),["assets/send-invoice-modal-c5c38164.js","assets/Toaster.svelte_svelte_type_style_lang-3086cbd0.js","assets/Toaster-3a6d0da3.css","assets/options-89ca2928.js","assets/updater-cbd8223a.js","assets/index-2f32262e.js","assets/x-e55b9835.js","assets/dialog-header-208ee491.js","assets/dialog-footer-e40dcf9d.js","assets/MiniStar-4e4614b7.js","assets/dialog-description-776c5d22.js","assets/dialog-description-42b79c51.js"]).then(i=>{e(6,x=i.default),e(7,E=!E),e(8,P=!0)})};function at(i){E=i,e(7,E)}function rt(i){te=i,e(11,te)}function ut(i){ne=i,e(12,ne)}function lt(i){ie=i,e(13,ie)}function ct(i){he.call(this,t,i)}return t.$$set=i=>{"nav"in i&&e(3,Y=i.nav),"selectedQuotationDate"in i&&e(0,Q=i.selectedQuotationDate),"selectedDueDate"in i&&e(24,z=i.selectedDueDate),"selectedDueDateBind"in i&&e(1,I=i.selectedDueDateBind),"selectedDueDateCustom"in i&&e(2,r=i.selectedDueDateCustom),"isSubmitting"in i&&e(4,_=i.isSubmitting),"isEdit"in i&&e(5,ee=i.isEdit)},t.$$.update=()=>{if(t.$$.dirty[0]&33554433){const i=l==null?void 0:l.value;i&&e(24,z=ge(Q).add(i,"days").format("YYYY-MM-DD"))}},[Q,I,r,Y,_,ee,x,E,P,ue,le,te,ne,ie,j,U,Z,W,J,F,oe,q,u,G,z,l,De,Ze,Je,xe,$e,et,tt,nt,it,ot,st,at,rt,ut,lt,ct]}class pn extends We{constructor(n){super(),ze(this,n,fn,mn,Ge,{nav:3,selectedQuotationDate:0,selectedDueDate:24,selectedDueDateBind:1,selectedDueDateCustom:2,isSubmitting:4,isEdit:5},null,[-1,-1])}}function _n(t){let n,e,o,s,c;function f(d){t[9](d)}function l(d){t[10](d)}function a(d){t[11](d)}let m={nav:t[4],isSubmitting:t[3]};return t[0]!==void 0&&(m.selectedQuotationDate=t[0]),t[1]!==void 0&&(m.selectedDueDate=t[1]),t[2]!==void 0&&(m.selectedDueDateCustom=t[2]),n=new pn({props:m}),A.push(()=>y(n,"selectedQuotationDate",f)),A.push(()=>y(n,"selectedDueDate",l)),A.push(()=>y(n,"selectedDueDateCustom",a)),n.$on("submit",t[6]),n.$on("createAndSend",t[7]),n.$on("updateDueDate",t[5]),{c(){L(n.$$.fragment)},m(d,g){O(n,d,g),c=!0},p(d,g){const T={};g[0]&8&&(T.isSubmitting=d[3]),!e&&g[0]&1&&(e=!0,T.selectedQuotationDate=d[0],v(()=>e=!1)),!o&&g[0]&2&&(o=!0,T.selectedDueDate=d[1],v(()=>o=!1)),!s&&g[0]&4&&(s=!0,T.selectedDueDateCustom=d[2],v(()=>s=!1)),n.$set(T)},i(d){c||(h(n.$$.fragment,d),c=!0)},o(d){k(n.$$.fragment,d),c=!1},d(d){B(n,d)}}}function gn(t,n,e){let o,s,c,f,l,a,m,d,g,T,N,M,K,R,j,U,V,b,D,Z,W,J,F;p(t,je,u=>e(13,o=u)),p(t,we,u=>e(14,s=u)),p(t,Ce,u=>e(15,c=u)),p(t,Pt,u=>e(16,f=u)),p(t,At,u=>e(17,l=u)),p(t,Pe,u=>e(18,a=u)),p(t,yt,u=>e(19,m=u)),p(t,Ee,u=>e(20,d=u)),p(t,Lt,u=>e(21,g=u)),p(t,Ot,u=>e(22,T=u)),p(t,Bt,u=>e(23,N=u)),p(t,qt,u=>e(24,M=u)),p(t,vt,u=>e(25,K=u)),p(t,Nt,u=>e(26,R=u)),p(t,Me,u=>e(27,j=u)),p(t,Qt,u=>e(28,U=u)),p(t,Ft,u=>e(29,V=u)),p(t,Ae,u=>e(30,b=u)),p(t,ye,u=>e(31,D=u)),p(t,Le,u=>e(32,Z=u)),p(t,pe,u=>e(33,W=u)),p(t,ke,u=>e(34,J=u)),p(t,_e,u=>e(8,F=u));const oe=[{name:"Quotation",link:"quotations"},{name:"Create",link:"quotation/create"}];let q,x,Y,Q,z,I=!1;const r=u=>{S(_e,F=u.detail,F);const G=parseInt(u.detail.value);if(G===0)e(1,Y=null);else{const De=G;e(1,Y=ge(x).add(De,"days").format("YYYY-MM-DD")),e(2,Q=null)}},_=()=>{S(pe,W++,W)},ee=()=>{let u=[];return Z||u.push("Issuer"),D||u.push("Customer"),q||u.push("Quotation date"),Y||Q||u.push("Due date"),b.length===0&&u.push("Product"),jt()||u.push("Payment method"),(!R||R.name==="none")&&u.push("Currency"),!T&&!N.name&&u.push("Bill to 'name'"),u.length>0?(se.error("Please fill missing fields: "+u.join(", ")+"."),!1):!0},E=()=>({id:J.toString()+W.toString(),prefix:J,number:W,business:Z,client:D,status:"active",quotationDate:q,dueDate:Y??Q,products:b,payments:Ut(),note:V,terms:U,internalNote:j,currency:R,subtotal:K,total:M,billedTo:N,billedToSameAsClient:T,discount:{total:g,data:d},tax:{total:m,data:a},reminder:{forClient:l,forAdmin:f,before:c,after:s}}),P=()=>{if(!ee())return;S(je,o=!0,o);const u=E();ue(u)},ue=u=>{e(3,z=!0),se.loading("Creating quotation..."),Dt(`quotation/create?email=${I}`,u,G=>{se.dismiss(),se.success("Quotation created successfully",{duration:5e3}),I&&G.data.emailSent?se.success("Quotation sent to email successfully",{duration:5e3}):I&&!G.data.emailSent&&se.error("Failed to send email",{duration:5e3}),ht(Tt.ALL.LOWER_CASE),_(),e(3,z=!1),window.location.replace(`#/quotation/${G.data.token}`)}).catch(G=>{e(3,z=!1),Yt(G,"invoice")})},le=()=>{I=!0,P()};function te(u){q=u,e(0,q)}function ne(u){Y=u,e(1,Y),e(8,F),e(35,x)}function ie(u){Q=u,e(2,Q)}return t.$$.update=()=>{if(t.$$.dirty[0]&256){const u=F==null?void 0:F.value;e(1,Y=u?ge(x).add(u,"days").format("YYYY-MM-DD"):null)}},[q,Y,Q,z,oe,r,P,le,F,te,ne,ie]}class ki extends We{constructor(n){super(),ze(this,n,gn,_n,Ge,{},null,[-1,-1])}}export{ki as default};
