import{S as Ze,i as ze,s as Ge,a4 as j,a5 as Q,c as _,m as g,a6 as X,j as m,t as $,l as b,X as z,Z as K,a as C,f as h,k as w,R as He,q as fe,p as Je,e as F,d as T,g as y,C as Ke,aa as Ue,o as W,h as x,x as L,B as We,Q as $e,u as ee,v as Oe,n as Re,w as xe,L as et}from"./Toaster.svelte_svelte_type_style_lang-89e761ff.js";import{R as tt,T as nt,D as lt}from"./options-1651b5d0.js";import{S as Ve,a as Be,b as Te,V as Ye,c as pe}from"./index-210676e1.js";import{L as U}from"./label-e50396f8.js";import{I as me}from"./input-ab223ce3.js";import{v as ue,M as rt,F as st,h as ut}from"./errorHelper-39e9d1d7.js";import{i as at}from"./emptyDataHelper-b583dd0c.js";import{a as ot,M as ae}from"./MiniStar-8026f138.js";import{C as it}from"./CustomCurrencyInput-e534ba6a.js";import{y as ct,f as Ae}from"./invoice-store-eba4366e.js";import{A as ft,b as pt}from"./index-838f84b3.js";import{D as mt}from"./dialog-description-ca00c0bf.js";import{D as $t}from"./dialog-header-5fe8b5ad.js";import{D as dt}from"./dialog-footer-37c988b6.js";function Pe(s,e,t){const n=s.slice();return n[29]=e[t],n}function _t(s){let e=s[4]||s[0]?"Edit Discount":"Add New Discount",t;return{c(){t=L(e)},m(n,l){h(n,t,l)},p(n,l){l[0]&17&&e!==(e=n[4]||n[0]?"Edit Discount":"Add New Discount")&&$e(t,e)},d(n){n&&w(t)}}}function gt(s){let e=s[4]||s[0]?"Edit the discount details below":"Fill in the details below to add a new discount",t;return{c(){t=L(e)},m(n,l){h(n,t,l)},p(n,l){l[0]&17&&e!==(e=n[4]||n[0]?"Edit the discount details below":"Fill in the details below to add a new discount")&&$e(t,e)},d(n){n&&w(t)}}}function bt(s){let e,t,n,l;return e=new ot({props:{$$slots:{default:[_t]},$$scope:{ctx:s}}}),n=new mt({props:{$$slots:{default:[gt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=C(),_(n.$$.fragment)},m(r,u){g(e,r,u),h(r,t,u),g(n,r,u),l=!0},p(r,u){const i={};u[0]&17|u[1]&2&&(i.$$scope={dirty:u,ctx:r}),e.$set(i);const a={};u[0]&17|u[1]&2&&(a.$$scope={dirty:u,ctx:r}),n.$set(a)},i(r){l||(m(e.$$.fragment,r),m(n.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),$(n.$$.fragment,r),l=!1},d(r){r&&w(t),b(e,r),b(n,r)}}}function Le(s){let e,t,n;return t=new ft({props:{variant:"warning",class:"mb-4",$$slots:{default:[ht]},$$scope:{ctx:s}}}),{c(){e=F("div"),_(t.$$.fragment),T(e,"class","mt-6")},m(l,r){h(l,e,r),g(t,e,null),n=!0},i(l){n||(m(t.$$.fragment,l),n=!0)},o(l){$(t.$$.fragment,l),n=!1},d(l){l&&w(e),b(t)}}}function vt(s){let e;return{c(){e=L("You are in temporary edit mode. Saving will only apply changes to the discount in the current invoice.")},m(t,n){h(t,e,n)},d(t){t&&w(e)}}}function ht(s){let e,t;return e=new pt({props:{$$slots:{default:[vt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(n,l){g(e,n,l),t=!0},p(n,l){const r={};l[1]&2&&(r.$$scope={dirty:l,ctx:n}),e.$set(r)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){b(e,n)}}}function wt(s){let e,t,n;return t=new ae({}),{c(){e=L("Name "),_(t.$$.fragment)},m(l,r){h(l,e,r),g(t,l,r),n=!0},i(l){n||(m(t.$$.fragment,l),n=!0)},o(l){$(t.$$.fragment,l),n=!1},d(l){l&&w(e),b(t,l)}}}function yt(s){let e;return{c(){e=L("Description")},m(t,n){h(t,e,n)},d(t){t&&w(e)}}}function kt(s){let e,t,n;return t=new ae({}),{c(){e=L("Type "),_(t.$$.fragment)},m(l,r){h(l,e,r),g(t,l,r),n=!0},i(l){n||(m(t.$$.fragment,l),n=!0)},o(l){$(t.$$.fragment,l),n=!1},d(l){l&&w(e),b(t,l)}}}function St(s){let e,t;return e=new Ye({props:{placeholder:"Select type"}}),{c(){_(e.$$.fragment)},m(n,l){g(e,n,l),t=!0},p:ee,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){b(e,n)}}}function Dt(s){let e;return{c(){e=L("Percent (%)")},m(t,n){h(t,e,n)},d(t){t&&w(e)}}}function Ct(s){let e;return{c(){e=L("Fixed")},m(t,n){h(t,e,n)},d(t){t&&w(e)}}}function Et(s){let e,t,n,l;return e=new pe({props:{value:"percent",$$slots:{default:[Dt]},$$scope:{ctx:s}}}),n=new pe({props:{value:"fixed",$$slots:{default:[Ct]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=C(),_(n.$$.fragment)},m(r,u){g(e,r,u),h(r,t,u),g(n,r,u),l=!0},p(r,u){const i={};u[1]&2&&(i.$$scope={dirty:u,ctx:r}),e.$set(i);const a={};u[1]&2&&(a.$$scope={dirty:u,ctx:r}),n.$set(a)},i(r){l||(m(e.$$.fragment,r),m(n.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),$(n.$$.fragment,r),l=!1},d(r){r&&w(t),b(e,r),b(n,r)}}}function qt(s){let e,t,n,l;return e=new Be({props:{id:"discount-type-select",class:"shadow-none",$$slots:{default:[St]},$$scope:{ctx:s}}}),n=new Te({props:{class:"max-h-60 overflow-y-auto",$$slots:{default:[Et]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=C(),_(n.$$.fragment)},m(r,u){g(e,r,u),h(r,t,u),g(n,r,u),l=!0},p(r,u){const i={};u[1]&2&&(i.$$scope={dirty:u,ctx:r}),e.$set(i);const a={};u[1]&2&&(a.$$scope={dirty:u,ctx:r}),n.$set(a)},i(r){l||(m(e.$$.fragment,r),m(n.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),$(n.$$.fragment,r),l=!1},d(r){r&&w(t),b(e,r),b(n,r)}}}function Ne(s){let e,t,n,l,r,u;t=new U({props:{for:"discount-currency-select",class:"mb-2",$$slots:{default:[Ot]},$$scope:{ctx:s}}});function i(o){s[18](o)}let a={required:!0,disabled:s[6].name!="none"&&!s[5],$$slots:{default:[Nt]},$$scope:{ctx:s}};return s[3].currency!==void 0&&(a.selected=s[3].currency),l=new Ve({props:a}),j.push(()=>Q(l,"selected",i)),{c(){e=F("div"),_(t.$$.fragment),n=C(),_(l.$$.fragment)},m(o,d){h(o,e,d),g(t,e,null),y(e,n),g(l,e,null),u=!0},p(o,d){const k={};d[1]&2&&(k.$$scope={dirty:d,ctx:o}),t.$set(k);const S={};d[0]&96&&(S.disabled=o[6].name!="none"&&!o[5]),d[0]&128|d[1]&2&&(S.$$scope={dirty:d,ctx:o}),!r&&d[0]&8&&(r=!0,S.selected=o[3].currency,X(()=>r=!1)),l.$set(S)},i(o){u||(m(t.$$.fragment,o),m(l.$$.fragment,o),u=!0)},o(o){$(t.$$.fragment,o),$(l.$$.fragment,o),u=!1},d(o){o&&w(e),b(t),b(l)}}}function Ot(s){let e,t,n;return t=new ae({}),{c(){e=L("Currency "),_(t.$$.fragment)},m(l,r){h(l,e,r),g(t,l,r),n=!0},i(l){n||(m(t.$$.fragment,l),n=!0)},o(l){$(t.$$.fragment,l),n=!1},d(l){l&&w(e),b(t,l)}}}function At(s){let e,t;return e=new Ye({props:{placeholder:"Select currency"}}),{c(){_(e.$$.fragment)},m(n,l){g(e,n,l),t=!0},p:ee,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){b(e,n)}}}function Fe(s){let e;return{c(){e=F("div"),e.textContent="You have no currencies saved",T(e,"class","text-sm p-2 text-muted-foreground italic")},m(t,n){h(t,e,n)},p:ee,d(t){t&&w(e)}}}function Pt(s){let e=s[29].name+"",t;return{c(){t=L(e)},m(n,l){h(n,t,l)},p(n,l){l[0]&128&&e!==(e=n[29].name+"")&&$e(t,e)},d(n){n&&w(t)}}}function Me(s){let e,t;return e=new pe({props:{value:s[29],$$slots:{default:[Pt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(n,l){g(e,n,l),t=!0},p(n,l){const r={};l[0]&128&&(r.value=n[29]),l[0]&128|l[1]&2&&(r.$$scope={dirty:l,ctx:n}),e.$set(r)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){b(e,n)}}}function Lt(s){let e,t,n=Oe(s[7]),l=[];for(let i=0;i<n.length;i+=1)l[i]=Me(Pe(s,n,i));const r=i=>$(l[i],1,1,()=>{l[i]=null});let u=null;return n.length||(u=Fe()),{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=Re(),u&&u.c()},m(i,a){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(i,a);h(i,e,a),u&&u.m(i,a),t=!0},p(i,a){if(a[0]&128){n=Oe(i[7]);let o;for(o=0;o<n.length;o+=1){const d=Pe(i,n,o);l[o]?(l[o].p(d,a),m(l[o],1)):(l[o]=Me(d),l[o].c(),m(l[o],1),l[o].m(e.parentNode,e))}for(W(),o=n.length;o<l.length;o+=1)r(o);x(),!n.length&&u?u.p(i,a):n.length?u&&(u.d(1),u=null):(u=Fe(),u.c(),u.m(e.parentNode,e))}},i(i){if(!t){for(let a=0;a<n.length;a+=1)m(l[a]);t=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)$(l[a]);t=!1},d(i){i&&w(e),xe(l,i),u&&u.d(i)}}}function Nt(s){let e,t,n,l;return e=new Be({props:{id:"discount-currency-select",class:"shadow-none",$$slots:{default:[At]},$$scope:{ctx:s}}}),n=new Te({props:{class:"max-h-60 overflow-y-auto",$$slots:{default:[Lt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=C(),_(n.$$.fragment)},m(r,u){g(e,r,u),h(r,t,u),g(n,r,u),l=!0},p(r,u){const i={};u[1]&2&&(i.$$scope={dirty:u,ctx:r}),e.$set(i);const a={};u[0]&128|u[1]&2&&(a.$$scope={dirty:u,ctx:r}),n.$set(a)},i(r){l||(m(e.$$.fragment,r),m(n.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),$(n.$$.fragment,r),l=!1},d(r){r&&w(t),b(e,r),b(n,r)}}}function Ft(s){let e,t,n;return t=new ae({}),{c(){e=L("Amount "),_(t.$$.fragment)},m(l,r){h(l,e,r),g(t,l,r),n=!0},i(l){n||(m(t.$$.fragment,l),n=!0)},o(l){$(t.$$.fragment,l),n=!1},d(l){l&&w(e),b(t,l)}}}function Mt(s){let e,t,n,l,r;function u(o){s[20](o)}let i={type:"number",max:"100",id:"discount-value",placeholder:"Discount amount",required:!0};s[3].value!==void 0&&(i.value=s[3].value),t=new me({props:i}),j.push(()=>Q(t,"value",u));let a=s[3].type.value==="percent"&&Ie();return{c(){e=F("div"),_(t.$$.fragment),l=C(),a&&a.c(),T(e,"class","flex flex-row items-center space-x-2")},m(o,d){h(o,e,d),g(t,e,null),y(e,l),a&&a.m(e,null),r=!0},p(o,d){const k={};!n&&d[0]&8&&(n=!0,k.value=o[3].value,X(()=>n=!1)),t.$set(k),o[3].type.value==="percent"?a||(a=Ie(),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i(o){r||(m(t.$$.fragment,o),r=!0)},o(o){$(t.$$.fragment,o),r=!1},d(o){o&&w(e),b(t),a&&a.d()}}}function It(s){var u,i,a;let e,t,n;function l(o){s[19](o)}let r={inputClass:"text-start",currencyName:(a=(i=(u=s[3])==null?void 0:u.currency)==null?void 0:i.label)==null?void 0:a.trim(),placeholder:"Discount amount"};return s[3].value!==void 0&&(r.value=s[3].value),e=new it({props:r}),j.push(()=>Q(e,"value",l)),{c(){_(e.$$.fragment)},m(o,d){g(e,o,d),n=!0},p(o,d){var S,q,O;const k={};d[0]&8&&(k.currencyName=(O=(q=(S=o[3])==null?void 0:S.currency)==null?void 0:q.label)==null?void 0:O.trim()),!t&&d[0]&8&&(t=!0,k.value=o[3].value,X(()=>t=!1)),e.$set(k)},i(o){n||(m(e.$$.fragment,o),n=!0)},o(o){$(e.$$.fragment,o),n=!1},d(o){b(e,o)}}}function Ie(s){let e;return{c(){e=F("div"),e.textContent="%"},m(t,n){h(t,e,n)},d(t){t&&w(e)}}}function Rt(s){let e;return{c(){e=L("Save")},m(t,n){h(t,e,n)},i:ee,o:ee,d(t){t&&w(e)}}}function Vt(s){let e,t,n;return e=new et({props:{class:"h-4 w-4 mr-1 animate-spin text-white"}}),{c(){_(e.$$.fragment),t=L(`
            Saving`)},m(l,r){g(e,l,r),h(l,t,r),n=!0},i(l){n||(m(e.$$.fragment,l),n=!0)},o(l){$(e.$$.fragment,l),n=!1},d(l){l&&w(t),b(e,l)}}}function Bt(s){let e,t,n,l;const r=[Vt,Rt],u=[];function i(a,o){return a[2]?0:1}return e=i(s),t=u[e]=r[e](s),{c(){t.c(),n=Re()},m(a,o){u[e].m(a,o),h(a,n,o),l=!0},p(a,o){let d=e;e=i(a),e!==d&&(W(),$(u[d],1,1,()=>{u[d]=null}),x(),t=u[e],t||(t=u[e]=r[e](a),t.c()),m(t,1),t.m(n.parentNode,n))},i(a){l||(m(t),l=!0)},o(a){$(t),l=!1},d(a){a&&w(n),u[e].d(a)}}}function Tt(s){let e,t;return e=new We({props:{type:"submit",disabled:s[2],$$slots:{default:[Bt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(n,l){g(e,n,l),t=!0},p(n,l){const r={};l[0]&4&&(r.disabled=n[2]),l[0]&4|l[1]&2&&(r.$$scope={dirty:l,ctx:n}),e.$set(r)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){b(e,n)}}}function Yt(s){let e,t,n,l,r,u,i,a,o,d,k,S,q,O,f,N,G,te,Y,I,ne,M,H,Z,J,R,V,le,A,P,re,c,se,oe,de;t=new $t({props:{$$slots:{default:[bt]},$$scope:{ctx:s}}});let E=s[0]&&Le(s);a=new U({props:{for:"discount-name",$$slots:{default:[wt]},$$scope:{ctx:s}}});function je(p){s[15](p)}let _e={id:"discount-name",type:"text",placeholder:"Discount name",required:!0};s[3].name!==void 0&&(_e.value=s[3].name),d=new me({props:_e}),j.push(()=>Q(d,"value",je)),O=new U({props:{for:"discount-description",$$slots:{default:[yt]},$$scope:{ctx:s}}});function Qe(p){s[16](p)}let ge={id:"discount-description",type:"text",placeholder:"Discount description"};s[3].description!==void 0&&(ge.value=s[3].description),N=new me({props:ge}),j.push(()=>Q(N,"value",Qe)),I=new U({props:{for:"discount-type-select",class:"mb-2",$$slots:{default:[kt]},$$scope:{ctx:s}}});function Xe(p){s[17](p)}let be={required:!0,onSelectedChange:s[11],$$slots:{default:[qt]},$$scope:{ctx:s}};s[3].type!==void 0&&(be.selected=s[3].type),M=new Ve({props:be}),j.push(()=>Q(M,"selected",Xe));let D=s[3].type.value==="fixed"&&Ne(s);V=new U({props:{for:"discount-value",$$slots:{default:[Ft]},$$scope:{ctx:s}}});const ve=[It,Mt],B=[];function he(p,v){return p[3].type.value==="fixed"?0:1}return A=he(s),P=B[A]=ve[A](s),c=new dt({props:{$$slots:{default:[Tt]},$$scope:{ctx:s}}}),{c(){e=F("form"),_(t.$$.fragment),n=C(),E&&E.c(),l=C(),r=F("div"),u=F("div"),i=F("div"),_(a.$$.fragment),o=C(),_(d.$$.fragment),S=C(),q=F("div"),_(O.$$.fragment),f=C(),_(N.$$.fragment),te=C(),Y=F("div"),_(I.$$.fragment),ne=C(),_(M.$$.fragment),Z=C(),D&&D.c(),J=C(),R=F("div"),_(V.$$.fragment),le=C(),P.c(),re=C(),_(c.$$.fragment),T(i,"class","space-y-2"),T(q,"class","space-y-2"),T(R,"class","space-y-2"),T(u,"class","grid grid-cols-1 items-center gap-4"),T(r,"class","grid gap-4 py-4")},m(p,v){h(p,e,v),g(t,e,null),y(e,n),E&&E.m(e,null),y(e,l),y(e,r),y(r,u),y(u,i),g(a,i,null),y(i,o),g(d,i,null),y(u,S),y(u,q),g(O,q,null),y(q,f),g(N,q,null),y(u,te),y(u,Y),g(I,Y,null),y(Y,ne),g(M,Y,null),y(u,Z),D&&D.m(u,null),y(u,J),y(u,R),g(V,R,null),y(R,le),B[A].m(R,null),y(e,re),g(c,e,null),se=!0,oe||(de=Ke(e,"submit",Ue(s[10])),oe=!0)},p(p,v){const we={};v[0]&17|v[1]&2&&(we.$$scope={dirty:v,ctx:p}),t.$set(we),p[0]?E?v[0]&1&&m(E,1):(E=Le(p),E.c(),m(E,1),E.m(e,l)):E&&(W(),$(E,1,1,()=>{E=null}),x());const ye={};v[1]&2&&(ye.$$scope={dirty:v,ctx:p}),a.$set(ye);const ke={};!k&&v[0]&8&&(k=!0,ke.value=p[3].name,X(()=>k=!1)),d.$set(ke);const Se={};v[1]&2&&(Se.$$scope={dirty:v,ctx:p}),O.$set(Se);const De={};!G&&v[0]&8&&(G=!0,De.value=p[3].description,X(()=>G=!1)),N.$set(De);const Ce={};v[1]&2&&(Ce.$$scope={dirty:v,ctx:p}),I.$set(Ce);const ie={};v[1]&2&&(ie.$$scope={dirty:v,ctx:p}),!H&&v[0]&8&&(H=!0,ie.selected=p[3].type,X(()=>H=!1)),M.$set(ie),p[3].type.value==="fixed"?D?(D.p(p,v),v[0]&8&&m(D,1)):(D=Ne(p),D.c(),m(D,1),D.m(u,J)):D&&(W(),$(D,1,1,()=>{D=null}),x());const Ee={};v[1]&2&&(Ee.$$scope={dirty:v,ctx:p}),V.$set(Ee);let ce=A;A=he(p),A===ce?B[A].p(p,v):(W(),$(B[ce],1,1,()=>{B[ce]=null}),x(),P=B[A],P?P.p(p,v):(P=B[A]=ve[A](p),P.c()),m(P,1),P.m(R,null));const qe={};v[0]&4|v[1]&2&&(qe.$$scope={dirty:v,ctx:p}),c.$set(qe)},i(p){se||(m(t.$$.fragment,p),m(E),m(a.$$.fragment,p),m(d.$$.fragment,p),m(O.$$.fragment,p),m(N.$$.fragment,p),m(I.$$.fragment,p),m(M.$$.fragment,p),m(D),m(V.$$.fragment,p),m(P),m(c.$$.fragment,p),se=!0)},o(p){$(t.$$.fragment,p),$(E),$(a.$$.fragment,p),$(d.$$.fragment,p),$(O.$$.fragment,p),$(N.$$.fragment,p),$(I.$$.fragment,p),$(M.$$.fragment,p),$(D),$(V.$$.fragment,p),$(P),$(c.$$.fragment,p),se=!1},d(p){p&&w(e),b(t),E&&E.d(),b(a),b(d),b(O),b(N),b(I),b(M),D&&D.d(),b(V),B[A].d(),b(c),oe=!1,de()}}}function jt(s){let e,t,n,l;return e=new nt({props:{id:"tax-modal"}}),n=new lt({props:{class:"sm:max-w-[425px] ",$$slots:{default:[Yt]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),t=C(),_(n.$$.fragment)},m(r,u){g(e,r,u),h(r,t,u),g(n,r,u),l=!0},p(r,u){const i={};u[0]&253|u[1]&2&&(i.$$scope={dirty:u,ctx:r}),n.$set(i)},i(r){l||(m(e.$$.fragment,r),m(n.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),$(n.$$.fragment,r),l=!1},d(r){r&&w(t),b(e,r),b(n,r)}}}function Qt(s){let e,t,n;function l(u){s[21](u)}let r={onOpenChange:s[9],$$slots:{default:[jt]},$$scope:{ctx:s}};return s[1]!==void 0&&(r.open=s[1]),e=new tt({props:r}),j.push(()=>Q(e,"open",l)),{c(){_(e.$$.fragment)},m(u,i){g(e,u,i),n=!0},p(u,i){const a={};i[0]&253|i[1]&2&&(a.$$scope={dirty:i,ctx:u}),!t&&i[0]&2&&(t=!0,a.open=u[1],X(()=>t=!1)),e.$set(a)},i(u){n||(m(e.$$.fragment,u),n=!0)},o(u){$(e.$$.fragment,u),n=!1},d(u){b(e,u)}}}function Xt(s,e,t){let n,l,r,u,i,a;z(s,ue,c=>t(22,n=c)),z(s,rt,c=>t(23,l=c)),z(s,ct,c=>t(6,r=c)),z(s,Ae,c=>t(24,u=c)),z(s,st,c=>t(14,i=c));let{isEditState:o=!1}=e,{isDeleteModalOpen:d=!1}=e,{temporaryEdit:k=!1}=e,{isOpen:S}=e,{isLoading:q}=e,{fromSetting:O=!1}=e,{payload:f={id:null,name:"",description:"",type:{value:"percent",label:"Percent (%)"},currency:{value:null,label:null},value:""}}=e,N=He([]);z(s,N,c=>t(7,a=c));const G=()=>{t(3,f={id:null,name:"",description:"",type:{value:"percent",label:"Percent (%)"},currency:{value:null,label:null},value:""})},te=()=>{t(1,S=!1),G()},Y=()=>{if(ne()){if(k){K(Ae,u[f.index]={name:f.name,description:f.description??null,type:f.type.value,currency:f.type.value=="percent"?null:f.currency.value,value:f.value},u),t(0,k=!1),t(1,S=!1);return}o?M():H()}},I=({value:c})=>{r.name!="none"?t(3,f.currency={value:r.name,label:r.name},f):t(3,f.currency=c==="fixed"?{label:l.name,value:{...l}}:{value:null,label:null},f),t(3,f.value=0,f)},ne=()=>{let c=!0;return f.type.value==="fixed"&&(!f.currency.value||!f.currency.label)&&(fe.error("Please choose currency"),c=!1),f.value||(fe.error("Please fill discount amount"),c=!1),c},M=()=>{K(ue,n[f.id]={id:f.id,name:f.name,description:f.description??null,type:f.type.value,currency:f.currency.value,value:parseFloat(f.value)},n),Z()},H=()=>{const c={name:f.name,description:f.description??null,type:f.type.value,currency:f.currency.value,value:parseFloat(f.value)};at(n)&&K(ue,n=[],n),K(ue,n=[...n,c],n),Z()},Z=()=>{q||(t(2,q=!0),fe.promise(Je("settings/update?tab=invoice",{discounts:n}),{loading:"Saving...",success:()=>(t(2,q=!1),t(1,S=!1),t(12,d=!1),"Discount Saved"),error:c=>(t(2,q=!1),ut(c,"Failed to save discount."))}))};function J(c){s.$$.not_equal(f.name,c)&&(f.name=c,t(3,f))}function R(c){s.$$.not_equal(f.description,c)&&(f.description=c,t(3,f))}function V(c){s.$$.not_equal(f.type,c)&&(f.type=c,t(3,f))}function le(c){s.$$.not_equal(f.currency,c)&&(f.currency=c,t(3,f))}function A(c){s.$$.not_equal(f.value,c)&&(f.value=c,t(3,f))}function P(c){s.$$.not_equal(f.value,c)&&(f.value=c,t(3,f))}function re(c){S=c,t(1,S)}return s.$$set=c=>{"isEditState"in c&&t(4,o=c.isEditState),"isDeleteModalOpen"in c&&t(12,d=c.isDeleteModalOpen),"temporaryEdit"in c&&t(0,k=c.temporaryEdit),"isOpen"in c&&t(1,S=c.isOpen),"isLoading"in c&&t(2,q=c.isLoading),"fromSetting"in c&&t(5,O=c.fromSetting),"payload"in c&&t(3,f=c.payload)},s.$$.update=()=>{s.$$.dirty[0]&16480&&K(N,a=i.filter(c=>O?!0:r.name==c.name),a)},[k,S,q,f,o,O,r,a,N,te,Y,I,d,Z,i,J,R,V,le,A,P,re]}class sn extends Ze{constructor(e){super(),ze(this,e,Xt,Qt,Ge,{isEditState:4,isDeleteModalOpen:12,temporaryEdit:0,isOpen:1,isLoading:2,fromSetting:5,payload:3,submit:13},null,[-1,-1])}get submit(){return this.$$.ctx[13]}}export{sn as A};
