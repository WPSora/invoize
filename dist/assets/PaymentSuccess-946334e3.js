import{S as ne,i as se,s as re,E as H,I as fe,c as k,m as P,F as me,G as pe,j as $,t as v,l as h,H as Y,J as de,K as _e,M as $e,N as ve,e as _,d as y,f as u,k as f,X as be,O as ge,n as oe,o as le,h as ae,P as Z,a as w,v as ce,B as ie,L as we,x as D,g,Q as F,p as ee}from"./Toaster.svelte_svelte_type_style_lang-3086cbd0.js";import{C as ye,i as ke,h as q,a as Pe}from"./errorHelper-eef9e97b.js";import{C as he}from"./card-footer-7cfda621.js";import{c as te}from"./decimalFormatter-88348579.js";import{B as xe}from"./badge-check-09e42ec2.js";import{X as ue}from"./x-e55b9835.js";import{C as Ie}from"./check-f7986a1f.js";function Ee(c){let e;const t=c[2].default,n=de(t,c,c[3],null);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&8)&&_e(n,t,r,r[3],e?ve(t,r[3],s,null):$e(r[3]),null)},i(r){e||($(n,r),e=!0)},o(r){v(n,r),e=!1},d(r){n&&n.d(r)}}}function De(c){let e,t;const n=[{name:"hourglass"},c[1],{iconNode:c[0]}];let r={$$slots:{default:[Ee]},$$scope:{ctx:c}};for(let s=0;s<n.length;s+=1)r=H(r,n[s]);return e=new fe({props:r}),{c(){k(e.$$.fragment)},m(s,o){P(e,s,o),t=!0},p(s,[o]){const l=o&3?me(n,[n[0],o&2&&pe(s[1]),o&1&&{iconNode:s[0]}]):{};o&8&&(l.$$scope={dirty:o,ctx:s}),e.$set(l)},i(s){t||($(e.$$.fragment,s),t=!0)},o(s){v(e.$$.fragment,s),t=!1},d(s){h(e,s)}}}function Ce(c,e,t){let{$$slots:n={},$$scope:r}=e;const s=[["path",{d:"M5 22h14"}],["path",{d:"M5 2h14"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2"}]];return c.$$set=o=>{t(1,e=H(H({},e),Y(o))),"$$scope"in o&&t(3,r=o.$$scope)},e=Y(e),[s,e,n,r]}class Se extends ne{constructor(e){super(),se(this,e,Ce,De,re,{})}}const Ne=Se,R={PENDING:"PENDING",PAID:"PAID",SETTLED:"SETTLED",EXPIRED:"EXPIRED"};function Te(c){let e,t,n,r,s,o;return e=new xe({props:{class:"h-40 w-40 text-green-600 mb-2"}}),n=new Pe({props:{class:"flex flex-col justify-center items-center text-center",$$slots:{default:[ze]},$$scope:{ctx:c}}}),s=new he({props:{$$slots:{default:[Ge]},$$scope:{ctx:c}}}),{c(){k(e.$$.fragment),t=w(),k(n.$$.fragment),r=w(),k(s.$$.fragment)},m(l,a){P(e,l,a),u(l,t,a),P(n,l,a),u(l,r,a),P(s,l,a),o=!0},p(l,a){const i={};a&8205&&(i.$$scope={dirty:a,ctx:l}),n.$set(i);const p={};a&8192&&(p.$$scope={dirty:a,ctx:l}),s.$set(p)},i(l){o||($(e.$$.fragment,l),$(n.$$.fragment,l),$(s.$$.fragment,l),o=!0)},o(l){v(e.$$.fragment,l),v(n.$$.fragment,l),v(s.$$.fragment,l),o=!1},d(l){l&&(f(t),f(r)),h(e,l),h(n,l),h(s,l)}}}function Me(c){let e,t,n,r,s,o;return e=new ue({props:{class:"h-40 w-40 text-destructive"}}),{c(){k(e.$$.fragment),t=w(),n=_("div"),n.textContent="Payment has Expired",r=w(),s=_("div"),s.textContent="Please contact your merchant.",y(n,"class","text-2xl font-bold")},m(l,a){P(e,l,a),u(l,t,a),u(l,n,a),u(l,r,a),u(l,s,a),o=!0},p:ce,i(l){o||($(e.$$.fragment,l),o=!0)},o(l){v(e.$$.fragment,l),o=!1},d(l){l&&(f(t),f(n),f(r),f(s)),h(e,l)}}}function Le(c){let e,t,n,r,s,o,l,a;return e=new Ne({props:{class:"h-40 w-40 text-yellow-500"}}),o=new ie({props:{$$slots:{default:[Be]},$$scope:{ctx:c}}}),{c(){k(e.$$.fragment),t=w(),n=_("div"),n.textContent="Waiting for Payment",r=w(),s=_("a"),k(o.$$.fragment),y(n,"class","text-2xl font-bold mb-2"),y(s,"href",l=c[1].invoice_url),y(s,"target","_self")},m(i,p){P(e,i,p),u(i,t,p),u(i,n,p),u(i,r,p),u(i,s,p),P(o,s,null),a=!0},p(i,p){const x={};p&8192&&(x.$$scope={dirty:p,ctx:i}),o.$set(x),(!a||p&2&&l!==(l=i[1].invoice_url))&&y(s,"href",l)},i(i){a||($(e.$$.fragment,i),$(o.$$.fragment,i),a=!0)},o(i){v(e.$$.fragment,i),v(o.$$.fragment,i),a=!1},d(i){i&&(f(t),f(n),f(r),f(s)),h(e,i),h(o)}}}function je(c){let e,t,n,r;return e=new we({props:{class:"h-40 w-40 text-primary animate-spin",strokeWidth:1}}),{c(){k(e.$$.fragment),t=w(),n=_("div"),n.textContent="Don't close this page while we process your payment...",y(n,"class","text-center")},m(s,o){P(e,s,o),u(s,t,o),u(s,n,o),r=!0},p:ce,i(s){r||($(e.$$.fragment,s),r=!0)},o(s){v(e.$$.fragment,s),r=!1},d(s){s&&(f(t),f(n)),h(e,s)}}}function Re(c){let e,t,n,r,s;return t=new ue({props:{class:"h-4 w-4 text-destructive"}}),{c(){e=_("div"),k(t.$$.fragment),n=w(),r=_("div"),r.textContent="Failed to update your invoice payment status. Please contact your merchant.",y(r,"class","text-sm"),y(e,"class","flex flex-nowrap items-center justify-center gap-2 mt-3")},m(o,l){u(o,e,l),P(t,e,null),g(e,n),g(e,r),s=!0},i(o){s||($(t.$$.fragment,o),s=!0)},o(o){v(t.$$.fragment,o),s=!1},d(o){o&&f(e),h(t)}}}function Xe(c){let e,t,n,r,s;return t=new Ie({props:{class:"h-4 w-4 text-green-600"}}),{c(){e=_("div"),k(t.$$.fragment),n=w(),r=_("div"),r.textContent="Invoice payment status has been updated",y(r,"class","text-sm"),y(e,"class","flex flex-nowrap items-center justify-center gap-2 mt-3")},m(o,l){u(o,e,l),P(t,e,null),g(e,n),g(e,r),s=!0},i(o){s||($(t.$$.fragment,o),s=!0)},o(o){v(t.$$.fragment,o),s=!1},d(o){o&&f(e),h(t)}}}function ze(c){var J,K;let e,t,n,r,s,o,l=c[0].invoiceNumber+"",a,i,p,x,X,M,N=te((K=(J=c[0])==null?void 0:J.currency)==null?void 0:K.name,c[0].total)+"",L,d,T,U,z,A,G,I,E,j,C;const V=[Xe,Re],S=[];function W(m,b){return m[3]?0:1}return I=W(c),E=S[I]=V[I](c),{c(){e=_("div"),e.textContent="Payment Successful",t=w(),n=_("div"),r=D("Your payment for "),s=_("b"),o=D("Invoice "),a=D(l),i=D(" has been successfully accepted."),p=w(),x=_("div"),X=D("Total Paid: "),M=_("b"),L=D(N),d=w(),T=_("div"),U=D("Payment Method: "),z=_("b"),A=D(c[2]),G=w(),E.c(),j=oe(),y(e,"class","text-2xl font-bold")},m(m,b){u(m,e,b),u(m,t,b),u(m,n,b),g(n,r),g(n,s),g(s,o),g(s,a),g(n,i),u(m,p,b),u(m,x,b),g(x,X),g(x,M),g(M,L),u(m,d,b),u(m,T,b),g(T,U),g(T,z),g(z,A),u(m,G,b),S[I].m(m,b),u(m,j,b),C=!0},p(m,b){var O,Q;(!C||b&1)&&l!==(l=m[0].invoiceNumber+"")&&F(a,l),(!C||b&1)&&N!==(N=te((Q=(O=m[0])==null?void 0:O.currency)==null?void 0:Q.name,m[0].total)+"")&&F(L,N),(!C||b&4)&&F(A,m[2]);let B=I;I=W(m),I!==B&&(le(),v(S[B],1,1,()=>{S[B]=null}),ae(),E=S[I],E||(E=S[I]=V[I](m),E.c()),$(E,1),E.m(j.parentNode,j))},i(m){C||($(E),C=!0)},o(m){v(E),C=!1},d(m){m&&(f(e),f(t),f(n),f(p),f(x),f(d),f(T),f(G),f(j)),S[I].d(m)}}}function Ae(c){let e;return{c(){e=D("Return to Invoice")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function Ge(c){let e,t;return e=new ie({props:{$$slots:{default:[Ae]},$$scope:{ctx:c}}}),e.$on("click",c[6]),{c(){k(e.$$.fragment)},m(n,r){P(e,n,r),t=!0},p(n,r){const s={};r&8192&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){v(e.$$.fragment,n),t=!1},d(n){h(e,n)}}}function Be(c){let e;return{c(){e=D("Pay now")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function Fe(c){let e,t,n,r;const s=[je,Le,Me,Te],o=[];function l(a,i){return!a[0]&&!a[4]&&!a[5]?0:a[4]?1:a[5]?2:3}return e=l(c),t=o[e]=s[e](c),{c(){t.c(),n=oe()},m(a,i){o[e].m(a,i),u(a,n,i),r=!0},p(a,i){let p=e;e=l(a),e===p?o[e].p(a,i):(le(),v(o[p],1,1,()=>{o[p]=null}),ae(),t=o[e],t?t.p(a,i):(t=o[e]=s[e](a),t.c()),$(t,1),t.m(n.parentNode,n))},i(a){r||($(t),r=!0)},o(a){v(t),r=!1},d(a){a&&f(n),o[e].d(a)}}}function qe(c){let e,t,n;return t=new ye({props:{class:"bg-gradient-to-tr from-slate-100 to-white flex flex-col justify-center items-center sm:w-1/2 w-10/12 h-1/2 relative",$$slots:{default:[Fe]},$$scope:{ctx:c}}}),{c(){e=_("div"),k(t.$$.fragment),y(e,"class","w-full h-screen bg-gradient-to-tr from-primary to-primary-600 flex justify-center items-center")},m(r,s){u(r,e,s),P(t,e,null),n=!0},p(r,[s]){const o={};s&8255&&(o.$$scope={dirty:s,ctx:r}),t.$set(o)},i(r){n||($(t.$$.fragment,r),n=!0)},o(r){v(t.$$.fragment,r),n=!1},d(r){r&&f(e),h(t)}}}function He(c,e,t){let n;be(c,ke,d=>t(8,n=d));let r,s,o,l,a=!1,i=!1,p=!1;const x=async()=>{try{const d=await Z(`invoice/detail?invoizeToken=${r}`);t(0,s=d.data),n&&console.log(s)}catch(d){q(d)}},X=async()=>{try{await ee(`invoice/update?token=${r}&paymentStatus=paid&email=true`),t(3,a=!0)}catch(d){t(3,a=!1),q(d)}finally{await ee(`xendit/update?invoizeToken=${r}`),x()}},M=()=>{window.location.href=`${invoize.base_url}/invoize-preview/${r}`},N=()=>{const d=window.location.href;d.includes("xendit")?t(2,l="Xendit"):d.includes("paypal")&&t(2,l="Paypal")},L=async()=>{try{const d=await Z(`xendit/detail?invoizeToken=${r}`);if(t(1,o=d.data.data),d.data.paymentStatus===R.PAID){t(3,a=!0),x();return}o.status===R.PAID||o.status===R.SETTLED?X():o.status===R.PENDING?t(4,i=!0):o.status===R.EXPIRED&&t(5,p=!0)}catch(d){q(d)}};return ge(()=>{N(),r=new URLSearchParams(window.location.search).get("invoizeToken"),L()}),[s,o,l,a,i,p,M]}class Ye extends ne{constructor(e){super(),se(this,e,He,qe,re,{})}}export{Ye as default};
